{"version":3,"sources":["caman.full.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"openseadragonimagefilter-vendor.js","sourcesContent":["// Generated by CoffeeScript 1.6.2\n(function() {\n  var $, Analyze, Blender, Calculate, Caman, CamanParser, Canvas, Convert, Event, Fiber, Filter, IO, Image, Layer, Log, Module, Pixel, Plugin, Renderer, Root, Store, Util, fs, moduleKeywords, slice, vignetteFilters,\n    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; },\n    __slice = [].slice,\n    __hasProp = {}.hasOwnProperty,\n    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\n  moduleKeywords = ['extended', 'included'];\n\n  Module = (function() {\n    function Module() {}\n\n    Module[\"extends\"] = function(obj) {\n      var key, value, _ref;\n\n      for (key in obj) {\n        value = obj[key];\n        if (__indexOf.call(moduleKeywords, key) < 0) {\n          this[key] = value;\n        }\n      }\n      if ((_ref = obj.extended) != null) {\n        _ref.apply(this);\n      }\n      return this;\n    };\n\n    Module.includes = function(obj) {\n      var key, value, _ref;\n\n      for (key in obj) {\n        value = obj[key];\n        if (__indexOf.call(moduleKeywords, key) < 0) {\n          this.prototype[key] = value;\n        }\n      }\n      if ((_ref = obj.included) != null) {\n        _ref.apply(this);\n      }\n      return this;\n    };\n\n    Module.delegate = function() {\n      var args, source, target, _i, _len, _results;\n\n      args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n      target = args.pop();\n      _results = [];\n      for (_i = 0, _len = args.length; _i < _len; _i++) {\n        source = args[_i];\n        _results.push(this.prototype[source] = target.prototype[source]);\n      }\n      return _results;\n    };\n\n    Module.aliasFunction = function(to, from) {\n      var _this = this;\n\n      return this.prototype[to] = function() {\n        var args;\n\n        args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n        return _this.prototype[from].apply(_this, args);\n      };\n    };\n\n    Module.aliasProperty = function(to, from) {\n      return Object.defineProperty(this.prototype, to, {\n        get: function() {\n          return this[from];\n        },\n        set: function(val) {\n          return this[from] = val;\n        }\n      });\n    };\n\n    Module.included = function(func) {\n      return func.call(this, this.prototype);\n    };\n\n    return Module;\n\n  })();\n\n  slice = Array.prototype.slice;\n\n  $ = function(sel, root) {\n    if (root == null) {\n      root = document;\n    }\n    if (typeof sel === \"object\" || (typeof exports !== \"undefined\" && exports !== null)) {\n      return sel;\n    }\n    return root.querySelector(sel);\n  };\n\n  Util = (function() {\n    function Util() {}\n\n    Util.uniqid = (function() {\n      var id;\n\n      id = 0;\n      return {\n        get: function() {\n          return id++;\n        }\n      };\n    })();\n\n    Util.extend = function() {\n      var copy, dest, obj, prop, src, _i, _len;\n\n      obj = arguments[0], src = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      dest = obj;\n      for (_i = 0, _len = src.length; _i < _len; _i++) {\n        copy = src[_i];\n        for (prop in copy) {\n          if (!__hasProp.call(copy, prop)) continue;\n          dest[prop] = copy[prop];\n        }\n      }\n      return dest;\n    };\n\n    Util.clampRGB = function(val) {\n      if (val < 0) {\n        return 0;\n      }\n      if (val > 255) {\n        return 255;\n      }\n      return val;\n    };\n\n    Util.copyAttributes = function(from, to, opts) {\n      var attr, _i, _len, _ref, _ref1, _results;\n\n      if (opts == null) {\n        opts = {};\n      }\n      _ref = from.attributes;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        attr = _ref[_i];\n        if ((opts.except != null) && (_ref1 = attr.nodeName, __indexOf.call(opts.except, _ref1) >= 0)) {\n          continue;\n        }\n        _results.push(to.setAttribute(attr.nodeName, attr.nodeValue));\n      }\n      return _results;\n    };\n\n    Util.dataArray = function(length) {\n      if (length == null) {\n        length = 0;\n      }\n      if (Caman.NodeJS || (window.Uint8Array != null)) {\n        return new Uint8Array(length);\n      }\n      return new Array(length);\n    };\n\n    return Util;\n\n  })();\n\n  if (typeof exports !== \"undefined\" && exports !== null) {\n    Root = exports;\n    Canvas = require('canvas');\n    Image = Canvas.Image;\n    Fiber = require('fibers');\n    fs = require('fs');\n  } else {\n    Root = window;\n  }\n\n  Caman = (function(_super) {\n    __extends(Caman, _super);\n\n    Caman.version = {\n      release: \"4.1.2\",\n      date: \"7/27/2013\"\n    };\n\n    Caman.DEBUG = false;\n\n    Caman.allowRevert = true;\n\n    Caman.crossOrigin = \"anonymous\";\n\n    Caman.remoteProxy = \"\";\n\n    Caman.proxyParam = \"camanProxyUrl\";\n\n    Caman.NodeJS = typeof exports !== \"undefined\" && exports !== null;\n\n    Caman.autoload = !Caman.NodeJS;\n\n    Caman.toString = function() {\n      return \"Version \" + Caman.version.release + \", Released \" + Caman.version.date;\n    };\n\n    Caman.getAttrId = function(canvas) {\n      if (Caman.NodeJS) {\n        return true;\n      }\n      if (typeof canvas === \"string\") {\n        canvas = $(canvas);\n      }\n      if (!((canvas != null) && (canvas.getAttribute != null))) {\n        return null;\n      }\n      return canvas.getAttribute('data-caman-id');\n    };\n\n    function Caman() {\n      this.nodeFileReady = __bind(this.nodeFileReady, this);\n      var args, callback, id,\n        _this = this;\n\n      if (arguments.length === 0) {\n        throw \"Invalid arguments\";\n      }\n      if (this instanceof Caman) {\n        this.finishInit = this.finishInit.bind(this);\n        this.imageLoaded = this.imageLoaded.bind(this);\n        args = arguments[0];\n        if (!Caman.NodeJS) {\n          id = parseInt(Caman.getAttrId(args[0]), 10);\n          callback = typeof args[1] === \"function\" ? args[1] : typeof args[2] === \"function\" ? args[2] : function() {};\n          if (!isNaN(id) && Store.has(id)) {\n            return Store.execute(id, callback);\n          }\n        }\n        this.id = Util.uniqid.get();\n        this.initializedPixelData = this.originalPixelData = null;\n        this.cropCoordinates = {\n          x: 0,\n          y: 0\n        };\n        this.cropped = false;\n        this.resized = false;\n        this.pixelStack = [];\n        this.layerStack = [];\n        this.canvasQueue = [];\n        this.currentLayer = null;\n        this.scaled = false;\n        this.analyze = new Analyze(this);\n        this.renderer = new Renderer(this);\n        this.domIsLoaded(function() {\n          _this.parseArguments(args);\n          return _this.setup();\n        });\n        return this;\n      } else {\n        return new Caman(arguments);\n      }\n    }\n\n    Caman.prototype.domIsLoaded = function(cb) {\n      var listener,\n        _this = this;\n\n      if (Caman.NodeJS) {\n        return setTimeout(function() {\n          return cb.call(_this);\n        }, 0);\n      } else {\n        if (document.readyState === \"complete\") {\n          Log.debug(\"DOM initialized\");\n          return setTimeout(function() {\n            return cb.call(_this);\n          }, 0);\n        } else {\n          listener = function() {\n            if (document.readyState === \"complete\") {\n              Log.debug(\"DOM initialized\");\n              return cb.call(_this);\n            }\n          };\n          return document.addEventListener(\"readystatechange\", listener, false);\n        }\n      }\n    };\n\n    Caman.prototype.parseArguments = function(args) {\n      var key, val, _ref, _results;\n\n      if (args.length === 0) {\n        throw \"Invalid arguments given\";\n      }\n      this.initObj = null;\n      this.initType = null;\n      this.imageUrl = null;\n      this.callback = function() {};\n      this.setInitObject(args[0]);\n      if (args.length === 1) {\n        return;\n      }\n      switch (typeof args[1]) {\n        case \"string\":\n          this.imageUrl = args[1];\n          break;\n        case \"function\":\n          this.callback = args[1];\n      }\n      if (args.length === 2) {\n        return;\n      }\n      this.callback = args[2];\n      if (args.length === 4) {\n        _ref = args[4];\n        _results = [];\n        for (key in _ref) {\n          if (!__hasProp.call(_ref, key)) continue;\n          val = _ref[key];\n          _results.push(this.options[key] = val);\n        }\n        return _results;\n      }\n    };\n\n    Caman.prototype.setInitObject = function(obj) {\n      if (Caman.NodeJS) {\n        this.initObj = obj;\n        this.initType = 'node';\n        return;\n      }\n      if (typeof obj === \"object\") {\n        this.initObj = obj;\n      } else {\n        this.initObj = $(obj);\n      }\n      if (this.initObj == null) {\n        throw \"Could not find image or canvas for initialization.\";\n      }\n      return this.initType = this.initObj.nodeName.toLowerCase();\n    };\n\n    Caman.prototype.setup = function() {\n      switch (this.initType) {\n        case \"node\":\n          return this.initNode();\n        case \"img\":\n          return this.initImage();\n        case \"canvas\":\n          return this.initCanvas();\n      }\n    };\n\n    Caman.prototype.initNode = function() {\n      Log.debug(\"Initializing for NodeJS\");\n      if (typeof this.initObj === \"string\") {\n        return fs.readFile(this.initObj, this.nodeFileReady);\n      } else {\n        return this.nodeFileReady(null, this.initObj);\n      }\n    };\n\n    Caman.prototype.nodeFileReady = function(err, data) {\n      if (err) {\n        throw err;\n      }\n      this.image = new Image();\n      this.image.src = data;\n      Log.debug(\"Image loaded. Width = \" + (this.imageWidth()) + \", Height = \" + (this.imageHeight()));\n      this.canvas = new Canvas(this.imageWidth(), this.imageHeight());\n      return this.finishInit();\n    };\n\n    Caman.prototype.initImage = function() {\n      this.image = this.initObj;\n      this.canvas = document.createElement('canvas');\n      this.context = this.canvas.getContext('2d');\n      Util.copyAttributes(this.image, this.canvas, {\n        except: ['src']\n      });\n      this.image.parentNode.replaceChild(this.canvas, this.image);\n      this.imageAdjustments();\n      return this.waitForImageLoaded();\n    };\n\n    Caman.prototype.initCanvas = function() {\n      this.canvas = this.initObj;\n      this.context = this.canvas.getContext('2d');\n      if (this.imageUrl != null) {\n        this.image = document.createElement('img');\n        this.image.src = this.imageUrl;\n        this.imageAdjustments();\n        return this.waitForImageLoaded();\n      } else {\n        return this.finishInit();\n      }\n    };\n\n    Caman.prototype.imageAdjustments = function() {\n      if (this.needsHiDPISwap()) {\n        Log.debug(this.image.src, \"->\", this.hiDPIReplacement());\n        this.swapped = true;\n        this.image.src = this.hiDPIReplacement();\n      }\n      if (IO.isRemote(this.image)) {\n        this.image.src = IO.proxyUrl(this.image.src);\n        return Log.debug(\"Remote image detected, using URL = \" + this.image.src);\n      }\n    };\n\n    Caman.prototype.waitForImageLoaded = function() {\n      if (this.isImageLoaded()) {\n        return this.imageLoaded();\n      } else {\n        return this.image.onload = this.imageLoaded;\n      }\n    };\n\n    Caman.prototype.isImageLoaded = function() {\n      if (!this.image.complete) {\n        return false;\n      }\n      if ((this.image.naturalWidth != null) && this.image.naturalWidth === 0) {\n        return false;\n      }\n      return true;\n    };\n\n    Caman.prototype.imageWidth = function() {\n      return this.image.width || this.image.naturalWidth;\n    };\n\n    Caman.prototype.imageHeight = function() {\n      return this.image.height || this.image.naturalHeight;\n    };\n\n    Caman.prototype.imageLoaded = function() {\n      Log.debug(\"Image loaded. Width = \" + (this.imageWidth()) + \", Height = \" + (this.imageHeight()));\n      if (this.swapped) {\n        this.canvas.width = this.imageWidth() / this.hiDPIRatio();\n        this.canvas.height = this.imageHeight() / this.hiDPIRatio();\n      } else {\n        this.canvas.width = this.imageWidth();\n        this.canvas.height = this.imageHeight();\n      }\n      return this.finishInit();\n    };\n\n    Caman.prototype.finishInit = function() {\n      var i, pixel, _i, _len, _ref;\n\n      if (this.context == null) {\n        this.context = this.canvas.getContext('2d');\n      }\n      this.originalWidth = this.preScaledWidth = this.width = this.canvas.width;\n      this.originalHeight = this.preScaledHeight = this.height = this.canvas.height;\n      this.hiDPIAdjustments();\n      if (!this.hasId()) {\n        this.assignId();\n      }\n      if (this.image != null) {\n        this.context.drawImage(this.image, 0, 0, this.imageWidth(), this.imageHeight(), 0, 0, this.preScaledWidth, this.preScaledHeight);\n      }\n      this.imageData = this.context.getImageData(0, 0, this.canvas.width, this.canvas.height);\n      this.pixelData = this.imageData.data;\n      if (Caman.allowRevert) {\n        this.initializedPixelData = Util.dataArray(this.pixelData.length);\n        this.originalPixelData = Util.dataArray(this.pixelData.length);\n        _ref = this.pixelData;\n        for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {\n          pixel = _ref[i];\n          this.initializedPixelData[i] = pixel;\n          this.originalPixelData[i] = pixel;\n        }\n      }\n      this.dimensions = {\n        width: this.canvas.width,\n        height: this.canvas.height\n      };\n      if (!Caman.NodeJS) {\n        Store.put(this.id, this);\n      }\n      this.callback.call(this, this);\n      return this.callback = function() {};\n    };\n\n    Caman.prototype.reloadCanvasData = function() {\n      this.imageData = this.context.getImageData(0, 0, this.canvas.width, this.canvas.height);\n      return this.pixelData = this.imageData.data;\n    };\n\n    Caman.prototype.resetOriginalPixelData = function() {\n      var i, pixel, _i, _len, _ref, _results;\n\n      if (!Caman.allowRevert) {\n        throw \"Revert disabled\";\n      }\n      this.originalPixelData = Util.dataArray(this.pixelData.length);\n      _ref = this.pixelData;\n      _results = [];\n      for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {\n        pixel = _ref[i];\n        _results.push(this.originalPixelData[i] = pixel);\n      }\n      return _results;\n    };\n\n    Caman.prototype.hasId = function() {\n      return Caman.getAttrId(this.canvas) != null;\n    };\n\n    Caman.prototype.assignId = function() {\n      if (Caman.NodeJS || this.canvas.getAttribute('data-caman-id')) {\n        return;\n      }\n      return this.canvas.setAttribute('data-caman-id', this.id);\n    };\n\n    Caman.prototype.hiDPIDisabled = function() {\n      return this.canvas.getAttribute('data-caman-hidpi-disabled') !== null;\n    };\n\n    Caman.prototype.hiDPIAdjustments = function() {\n      var ratio;\n\n      if (Caman.NodeJS || !this.needsHiDPISwap()) {\n        return;\n      }\n      ratio = this.hiDPIRatio();\n      if (ratio !== 1) {\n        Log.debug(\"HiDPI ratio = \" + ratio);\n        this.scaled = true;\n        this.preScaledWidth = this.canvas.width;\n        this.preScaledHeight = this.canvas.height;\n        this.canvas.width = this.preScaledWidth * ratio;\n        this.canvas.height = this.preScaledHeight * ratio;\n        this.canvas.style.width = \"\" + this.preScaledWidth + \"px\";\n        this.canvas.style.height = \"\" + this.preScaledHeight + \"px\";\n        this.context.scale(ratio, ratio);\n        this.width = this.originalWidth = this.canvas.width;\n        return this.height = this.originalHeight = this.canvas.height;\n      }\n    };\n\n    Caman.prototype.hiDPIRatio = function() {\n      var backingStoreRatio, devicePixelRatio;\n\n      devicePixelRatio = window.devicePixelRatio || 1;\n      backingStoreRatio = this.context.webkitBackingStorePixelRatio || this.context.mozBackingStorePixelRatio || this.context.msBackingStorePixelRatio || this.context.oBackingStorePixelRatio || this.context.backingStorePixelRatio || 1;\n      return devicePixelRatio / backingStoreRatio;\n    };\n\n    Caman.prototype.hiDPICapable = function() {\n      return (window.devicePixelRatio != null) && window.devicePixelRatio !== 1;\n    };\n\n    Caman.prototype.needsHiDPISwap = function() {\n      if (this.hiDPIDisabled() || !this.hiDPICapable()) {\n        return false;\n      }\n      return this.hiDPIReplacement() !== null;\n    };\n\n    Caman.prototype.hiDPIReplacement = function() {\n      if (this.image == null) {\n        return null;\n      }\n      return this.image.getAttribute('data-caman-hidpi');\n    };\n\n    Caman.prototype.replaceCanvas = function(newCanvas) {\n      var oldCanvas;\n\n      oldCanvas = this.canvas;\n      this.canvas = newCanvas;\n      this.context = this.canvas.getContext('2d');\n      if (!Caman.NodeJS) {\n        oldCanvas.parentNode.replaceChild(this.canvas, oldCanvas);\n      }\n      this.width = this.canvas.width;\n      this.height = this.canvas.height;\n      this.reloadCanvasData();\n      return this.dimensions = {\n        width: this.canvas.width,\n        height: this.canvas.height\n      };\n    };\n\n    Caman.prototype.render = function(callback) {\n      var _this = this;\n\n      if (callback == null) {\n        callback = function() {};\n      }\n      Event.trigger(this, \"renderStart\");\n      return this.renderer.execute(function() {\n        _this.context.putImageData(_this.imageData, 0, 0);\n        return callback.call(_this);\n      });\n    };\n\n    Caman.prototype.revert = function(updateContext) {\n      var i, pixel, _i, _len, _ref;\n\n      if (updateContext == null) {\n        updateContext = true;\n      }\n      if (!Caman.allowRevert) {\n        throw \"Revert disabled\";\n      }\n      _ref = this.originalVisiblePixels();\n      for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {\n        pixel = _ref[i];\n        this.pixelData[i] = pixel;\n      }\n      if (updateContext) {\n        return this.context.putImageData(this.imageData, 0, 0);\n      }\n    };\n\n    Caman.prototype.reset = function() {\n      var canvas, ctx, i, imageData, pixel, pixelData, _i, _len, _ref;\n\n      canvas = document.createElement('canvas');\n      Util.copyAttributes(this.canvas, canvas);\n      canvas.width = this.originalWidth;\n      canvas.height = this.originalHeight;\n      ctx = canvas.getContext('2d');\n      imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n      pixelData = imageData.data;\n      _ref = this.initializedPixelData;\n      for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {\n        pixel = _ref[i];\n        pixelData[i] = pixel;\n      }\n      ctx.putImageData(imageData, 0, 0);\n      this.cropCoordinates = {\n        x: 0,\n        y: 0\n      };\n      this.resized = false;\n      return this.replaceCanvas(canvas);\n    };\n\n    Caman.prototype.originalVisiblePixels = function() {\n      var canvas, coord, ctx, endX, endY, i, imageData, pixel, pixelData, pixels, scaledCanvas, startX, startY, width, _i, _j, _len, _ref, _ref1, _ref2, _ref3;\n\n      if (!Caman.allowRevert) {\n        throw \"Revert disabled\";\n      }\n      pixels = [];\n      startX = this.cropCoordinates.x;\n      endX = startX + this.width;\n      startY = this.cropCoordinates.y;\n      endY = startY + this.height;\n      if (this.resized) {\n        canvas = document.createElement('canvas');\n        canvas.width = this.originalWidth;\n        canvas.height = this.originalHeight;\n        ctx = canvas.getContext('2d');\n        imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n        pixelData = imageData.data;\n        _ref = this.originalPixelData;\n        for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {\n          pixel = _ref[i];\n          pixelData[i] = pixel;\n        }\n        ctx.putImageData(imageData, 0, 0);\n        scaledCanvas = document.createElement('canvas');\n        scaledCanvas.width = this.width;\n        scaledCanvas.height = this.height;\n        ctx = scaledCanvas.getContext('2d');\n        ctx.drawImage(canvas, 0, 0, this.originalWidth, this.originalHeight, 0, 0, this.width, this.height);\n        pixelData = ctx.getImageData(0, 0, this.width, this.height).data;\n        width = this.width;\n      } else {\n        pixelData = this.originalPixelData;\n        width = this.originalWidth;\n      }\n      for (i = _j = 0, _ref1 = pixelData.length; _j < _ref1; i = _j += 4) {\n        coord = Pixel.locationToCoordinates(i, width);\n        if (((startX <= (_ref2 = coord.x) && _ref2 < endX)) && ((startY <= (_ref3 = coord.y) && _ref3 < endY))) {\n          pixels.push(pixelData[i], pixelData[i + 1], pixelData[i + 2], pixelData[i + 3]);\n        }\n      }\n      return pixels;\n    };\n\n    Caman.prototype.process = function(name, processFn) {\n      this.renderer.add({\n        type: Filter.Type.Single,\n        name: name,\n        processFn: processFn\n      });\n      return this;\n    };\n\n    Caman.prototype.processKernel = function(name, adjust, divisor, bias) {\n      var i, _i, _ref;\n\n      if (divisor == null) {\n        divisor = null;\n      }\n      if (bias == null) {\n        bias = 0;\n      }\n      if (divisor == null) {\n        divisor = 0;\n        for (i = _i = 0, _ref = adjust.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\n          divisor += adjust[i];\n        }\n      }\n      this.renderer.add({\n        type: Filter.Type.Kernel,\n        name: name,\n        adjust: adjust,\n        divisor: divisor,\n        bias: bias\n      });\n      return this;\n    };\n\n    Caman.prototype.processPlugin = function(plugin, args) {\n      this.renderer.add({\n        type: Filter.Type.Plugin,\n        plugin: plugin,\n        args: args\n      });\n      return this;\n    };\n\n    Caman.prototype.newLayer = function(callback) {\n      var layer;\n\n      layer = new Layer(this);\n      this.canvasQueue.push(layer);\n      this.renderer.add({\n        type: Filter.Type.LayerDequeue\n      });\n      callback.call(layer);\n      this.renderer.add({\n        type: Filter.Type.LayerFinished\n      });\n      return this;\n    };\n\n    Caman.prototype.executeLayer = function(layer) {\n      return this.pushContext(layer);\n    };\n\n    Caman.prototype.pushContext = function(layer) {\n      this.layerStack.push(this.currentLayer);\n      this.pixelStack.push(this.pixelData);\n      this.currentLayer = layer;\n      return this.pixelData = layer.pixelData;\n    };\n\n    Caman.prototype.popContext = function() {\n      this.pixelData = this.pixelStack.pop();\n      return this.currentLayer = this.layerStack.pop();\n    };\n\n    Caman.prototype.applyCurrentLayer = function() {\n      return this.currentLayer.applyToParent();\n    };\n\n    return Caman;\n\n  })(Module);\n\n  Root.Caman = Caman;\n\n  Caman.Analyze = (function() {\n    function Analyze(c) {\n      this.c = c;\n    }\n\n    Analyze.prototype.calculateLevels = function() {\n      var i, levels, numPixels, _i, _j, _k, _ref;\n\n      levels = {\n        r: {},\n        g: {},\n        b: {}\n      };\n      for (i = _i = 0; _i <= 255; i = ++_i) {\n        levels.r[i] = 0;\n        levels.g[i] = 0;\n        levels.b[i] = 0;\n      }\n      for (i = _j = 0, _ref = this.c.pixelData.length; _j < _ref; i = _j += 4) {\n        levels.r[this.c.pixelData[i]]++;\n        levels.g[this.c.pixelData[i + 1]]++;\n        levels.b[this.c.pixelData[i + 2]]++;\n      }\n      numPixels = this.c.pixelData.length / 4;\n      for (i = _k = 0; _k <= 255; i = ++_k) {\n        levels.r[i] /= numPixels;\n        levels.g[i] /= numPixels;\n        levels.b[i] /= numPixels;\n      }\n      return levels;\n    };\n\n    return Analyze;\n\n  })();\n\n  Analyze = Caman.Analyze;\n\n  Caman.DOMUpdated = function() {\n    var img, imgs, parser, _i, _len, _results;\n\n    imgs = document.querySelectorAll(\"img[data-caman]\");\n    if (!(imgs.length > 0)) {\n      return;\n    }\n    _results = [];\n    for (_i = 0, _len = imgs.length; _i < _len; _i++) {\n      img = imgs[_i];\n      _results.push(parser = new CamanParser(img, function() {\n        this.parse();\n        return this.execute();\n      }));\n    }\n    return _results;\n  };\n\n  if (Caman.autoload) {\n    (function() {\n      if (document.readyState === \"complete\") {\n        return Caman.DOMUpdated();\n      } else {\n        return document.addEventListener(\"DOMContentLoaded\", Caman.DOMUpdated, false);\n      }\n    })();\n  }\n\n  CamanParser = (function() {\n    var INST_REGEX;\n\n    INST_REGEX = \"(\\\\w+)\\\\((.*?)\\\\)\";\n\n    function CamanParser(ele, ready) {\n      this.dataStr = ele.getAttribute('data-caman');\n      this.caman = Caman(ele, ready.bind(this));\n    }\n\n    CamanParser.prototype.parse = function() {\n      var args, e, filter, func, inst, instFunc, m, r, unparsedInstructions, _i, _len, _ref, _results;\n\n      this.ele = this.caman.canvas;\n      r = new RegExp(INST_REGEX, 'g');\n      unparsedInstructions = this.dataStr.match(r);\n      if (!(unparsedInstructions.length > 0)) {\n        return;\n      }\n      r = new RegExp(INST_REGEX);\n      _results = [];\n      for (_i = 0, _len = unparsedInstructions.length; _i < _len; _i++) {\n        inst = unparsedInstructions[_i];\n        _ref = inst.match(r), m = _ref[0], filter = _ref[1], args = _ref[2];\n        instFunc = new Function(\"return function() {        this.\" + filter + \"(\" + args + \");      };\");\n        try {\n          func = instFunc();\n          _results.push(func.call(this.caman));\n        } catch (_error) {\n          e = _error;\n          _results.push(Log.debug(e));\n        }\n      }\n      return _results;\n    };\n\n    CamanParser.prototype.execute = function() {\n      var ele;\n\n      ele = this.ele;\n      return this.caman.render(function() {\n        return ele.parentNode.replaceChild(this.toImage(), ele);\n      });\n    };\n\n    return CamanParser;\n\n  })();\n\n  Caman.Blender = (function() {\n    function Blender() {}\n\n    Blender.blenders = {};\n\n    Blender.register = function(name, func) {\n      return this.blenders[name] = func;\n    };\n\n    Blender.execute = function(name, rgbaLayer, rgbaParent) {\n      return this.blenders[name](rgbaLayer, rgbaParent);\n    };\n\n    return Blender;\n\n  })();\n\n  Blender = Caman.Blender;\n\n  Caman.Calculate = (function() {\n    function Calculate() {}\n\n    Calculate.distance = function(x1, y1, x2, y2) {\n      return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n    };\n\n    Calculate.randomRange = function(min, max, getFloat) {\n      var rand;\n\n      if (getFloat == null) {\n        getFloat = false;\n      }\n      rand = min + (Math.random() * (max - min));\n      if (getFloat) {\n        return rand.toFixed(getFloat);\n      } else {\n        return Math.round(rand);\n      }\n    };\n\n    Calculate.luminance = function(rgba) {\n      return (0.299 * rgba.r) + (0.587 * rgba.g) + (0.114 * rgba.b);\n    };\n\n    Calculate.bezier = function(start, ctrl1, ctrl2, end, lowBound, highBound) {\n      var Ax, Ay, Bx, By, Cx, Cy, bezier, curveX, curveY, i, j, leftCoord, rightCoord, t, x0, x1, x2, x3, y0, y1, y2, y3, _i, _j, _k, _ref, _ref1;\n\n      x0 = start[0];\n      y0 = start[1];\n      x1 = ctrl1[0];\n      y1 = ctrl1[1];\n      x2 = ctrl2[0];\n      y2 = ctrl2[1];\n      x3 = end[0];\n      y3 = end[1];\n      bezier = {};\n      Cx = parseInt(3 * (x1 - x0), 10);\n      Bx = 3 * (x2 - x1) - Cx;\n      Ax = x3 - x0 - Cx - Bx;\n      Cy = 3 * (y1 - y0);\n      By = 3 * (y2 - y1) - Cy;\n      Ay = y3 - y0 - Cy - By;\n      for (i = _i = 0; _i < 1000; i = ++_i) {\n        t = i / 1000;\n        curveX = Math.round((Ax * Math.pow(t, 3)) + (Bx * Math.pow(t, 2)) + (Cx * t) + x0);\n        curveY = Math.round((Ay * Math.pow(t, 3)) + (By * Math.pow(t, 2)) + (Cy * t) + y0);\n        if (lowBound && curveY < lowBound) {\n          curveY = lowBound;\n        } else if (highBound && curveY > highBound) {\n          curveY = highBound;\n        }\n        bezier[curveX] = curveY;\n      }\n      if (bezier.length < end[0] + 1) {\n        for (i = _j = 0, _ref = end[0]; 0 <= _ref ? _j <= _ref : _j >= _ref; i = 0 <= _ref ? ++_j : --_j) {\n          if (bezier[i] == null) {\n            leftCoord = [i - 1, bezier[i - 1]];\n            for (j = _k = i, _ref1 = end[0]; i <= _ref1 ? _k <= _ref1 : _k >= _ref1; j = i <= _ref1 ? ++_k : --_k) {\n              if (bezier[j] != null) {\n                rightCoord = [j, bezier[j]];\n                break;\n              }\n            }\n            bezier[i] = leftCoord[1] + ((rightCoord[1] - leftCoord[1]) / (rightCoord[0] - leftCoord[0])) * (i - leftCoord[0]);\n          }\n        }\n      }\n      if (bezier[end[0]] == null) {\n        bezier[end[0]] = bezier[end[0] - 1];\n      }\n      return bezier;\n    };\n\n    return Calculate;\n\n  })();\n\n  Calculate = Caman.Calculate;\n\n  Caman.Convert = (function() {\n    function Convert() {}\n\n    Convert.hexToRGB = function(hex) {\n      var b, g, r;\n\n      if (hex.charAt(0) === \"#\") {\n        hex = hex.substr(1);\n      }\n      r = parseInt(hex.substr(0, 2), 16);\n      g = parseInt(hex.substr(2, 2), 16);\n      b = parseInt(hex.substr(4, 2), 16);\n      return {\n        r: r,\n        g: g,\n        b: b\n      };\n    };\n\n    Convert.rgbToHSL = function(r, g, b) {\n      var d, h, l, max, min, s;\n\n      if (typeof r === \"object\") {\n        g = r.g;\n        b = r.b;\n        r = r.r;\n      }\n      r /= 255;\n      g /= 255;\n      b /= 255;\n      max = Math.max(r, g, b);\n      min = Math.min(r, g, b);\n      l = (max + min) / 2;\n      if (max === min) {\n        h = s = 0;\n      } else {\n        d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        h = (function() {\n          switch (max) {\n            case r:\n              return (g - b) / d + (g < b ? 6 : 0);\n            case g:\n              return (b - r) / d + 2;\n            case b:\n              return (r - g) / d + 4;\n          }\n        })();\n        h /= 6;\n      }\n      return {\n        h: h,\n        s: s,\n        l: l\n      };\n    };\n\n    Convert.hslToRGB = function(h, s, l) {\n      var b, g, p, q, r;\n\n      if (typeof h === \"object\") {\n        s = h.s;\n        l = h.l;\n        h = h.h;\n      }\n      if (s === 0) {\n        r = g = b = l;\n      } else {\n        q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n        p = 2 * l - q;\n        r = this.hueToRGB(p, q, h + 1 / 3);\n        g = this.hueToRGB(p, q, h);\n        b = this.hueToRGB(p, q, h - 1 / 3);\n      }\n      return {\n        r: r * 255,\n        g: g * 255,\n        b: b * 255\n      };\n    };\n\n    Convert.hueToRGB = function(p, q, t) {\n      if (t < 0) {\n        t += 1;\n      }\n      if (t > 1) {\n        t -= 1;\n      }\n      if (t < 1 / 6) {\n        return p + (q - p) * 6 * t;\n      }\n      if (t < 1 / 2) {\n        return q;\n      }\n      if (t < 2 / 3) {\n        return p + (q - p) * (2 / 3 - t) * 6;\n      }\n      return p;\n    };\n\n    Convert.rgbToHSV = function(r, g, b) {\n      var d, h, max, min, s, v;\n\n      r /= 255;\n      g /= 255;\n      b /= 255;\n      max = Math.max(r, g, b);\n      min = Math.min(r, g, b);\n      v = max;\n      d = max - min;\n      s = max === 0 ? 0 : d / max;\n      if (max === min) {\n        h = 0;\n      } else {\n        h = (function() {\n          switch (max) {\n            case r:\n              return (g - b) / d + (g < b ? 6 : 0);\n            case g:\n              return (b - r) / d + 2;\n            case b:\n              return (r - g) / d + 4;\n          }\n        })();\n        h /= 6;\n      }\n      return {\n        h: h,\n        s: s,\n        v: v\n      };\n    };\n\n    Convert.hsvToRGB = function(h, s, v) {\n      var b, f, g, i, p, q, r, t;\n\n      i = Math.floor(h * 6);\n      f = h * 6 - i;\n      p = v * (1 - s);\n      q = v * (1 - f * s);\n      t = v * (1 - (1 - f) * s);\n      switch (i % 6) {\n        case 0:\n          r = v;\n          g = t;\n          b = p;\n          break;\n        case 1:\n          r = q;\n          g = v;\n          b = p;\n          break;\n        case 2:\n          r = p;\n          g = v;\n          b = t;\n          break;\n        case 3:\n          r = p;\n          g = q;\n          b = v;\n          break;\n        case 4:\n          r = t;\n          g = p;\n          b = v;\n          break;\n        case 5:\n          r = v;\n          g = p;\n          b = q;\n      }\n      return {\n        r: Math.floor(r * 255),\n        g: Math.floor(g * 255),\n        b: Math.floor(b * 255)\n      };\n    };\n\n    Convert.rgbToXYZ = function(r, g, b) {\n      var x, y, z;\n\n      r /= 255;\n      g /= 255;\n      b /= 255;\n      if (r > 0.04045) {\n        r = Math.pow((r + 0.055) / 1.055, 2.4);\n      } else {\n        r /= 12.92;\n      }\n      if (g > 0.04045) {\n        g = Math.pow((g + 0.055) / 1.055, 2.4);\n      } else {\n        g /= 12.92;\n      }\n      if (b > 0.04045) {\n        b = Math.pow((b + 0.055) / 1.055, 2.4);\n      } else {\n        b /= 12.92;\n      }\n      x = r * 0.4124 + g * 0.3576 + b * 0.1805;\n      y = r * 0.2126 + g * 0.7152 + b * 0.0722;\n      z = r * 0.0193 + g * 0.1192 + b * 0.9505;\n      return {\n        x: x * 100,\n        y: y * 100,\n        z: z * 100\n      };\n    };\n\n    Convert.xyzToRGB = function(x, y, z) {\n      var b, g, r;\n\n      x /= 100;\n      y /= 100;\n      z /= 100;\n      r = (3.2406 * x) + (-1.5372 * y) + (-0.4986 * z);\n      g = (-0.9689 * x) + (1.8758 * y) + (0.0415 * z);\n      b = (0.0557 * x) + (-0.2040 * y) + (1.0570 * z);\n      if (r > 0.0031308) {\n        r = (1.055 * Math.pow(r, 0.4166666667)) - 0.055;\n      } else {\n        r *= 12.92;\n      }\n      if (g > 0.0031308) {\n        g = (1.055 * Math.pow(g, 0.4166666667)) - 0.055;\n      } else {\n        g *= 12.92;\n      }\n      if (b > 0.0031308) {\n        b = (1.055 * Math.pow(b, 0.4166666667)) - 0.055;\n      } else {\n        b *= 12.92;\n      }\n      return {\n        r: r * 255,\n        g: g * 255,\n        b: b * 255\n      };\n    };\n\n    Convert.xyzToLab = function(x, y, z) {\n      var a, b, l, whiteX, whiteY, whiteZ;\n\n      if (typeof x === \"object\") {\n        y = x.y;\n        z = x.z;\n        x = x.x;\n      }\n      whiteX = 95.047;\n      whiteY = 100.0;\n      whiteZ = 108.883;\n      x /= whiteX;\n      y /= whiteY;\n      z /= whiteZ;\n      if (x > 0.008856451679) {\n        x = Math.pow(x, 0.3333333333);\n      } else {\n        x = (7.787037037 * x) + 0.1379310345;\n      }\n      if (y > 0.008856451679) {\n        y = Math.pow(y, 0.3333333333);\n      } else {\n        y = (7.787037037 * y) + 0.1379310345;\n      }\n      if (z > 0.008856451679) {\n        z = Math.pow(z, 0.3333333333);\n      } else {\n        z = (7.787037037 * z) + 0.1379310345;\n      }\n      l = 116 * y - 16;\n      a = 500 * (x - y);\n      b = 200 * (y - z);\n      return {\n        l: l,\n        a: a,\n        b: b\n      };\n    };\n\n    Convert.labToXYZ = function(l, a, b) {\n      var x, y, z;\n\n      if (typeof l === \"object\") {\n        a = l.a;\n        b = l.b;\n        l = l.l;\n      }\n      y = (l + 16) / 116;\n      x = y + (a / 500);\n      z = y - (b / 200);\n      if (x > 0.2068965517) {\n        x = x * x * x;\n      } else {\n        x = 0.1284185493 * (x - 0.1379310345);\n      }\n      if (y > 0.2068965517) {\n        y = y * y * y;\n      } else {\n        y = 0.1284185493 * (y - 0.1379310345);\n      }\n      if (z > 0.2068965517) {\n        z = z * z * z;\n      } else {\n        z = 0.1284185493 * (z - 0.1379310345);\n      }\n      return {\n        x: x * 95.047,\n        y: y * 100.0,\n        z: z * 108.883\n      };\n    };\n\n    Convert.rgbToLab = function(r, g, b) {\n      var xyz;\n\n      if (typeof r === \"object\") {\n        g = r.g;\n        b = r.b;\n        r = r.r;\n      }\n      xyz = this.rgbToXYZ(r, g, b);\n      return this.xyzToLab(xyz);\n    };\n\n    Convert.labToRGB = function(l, a, b) {};\n\n    return Convert;\n\n  })();\n\n  Convert = Caman.Convert;\n\n  Caman.Event = (function() {\n    function Event() {}\n\n    Event.events = {};\n\n    Event.types = [\"processStart\", \"processComplete\", \"renderStart\", \"renderFinished\", \"blockStarted\", \"blockFinished\"];\n\n    Event.trigger = function(target, type, data) {\n      var event, _i, _len, _ref, _results;\n\n      if (data == null) {\n        data = null;\n      }\n      if (this.events[type] && this.events[type].length) {\n        _ref = this.events[type];\n        _results = [];\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          event = _ref[_i];\n          if (event.target === null || target.id === event.target.id) {\n            _results.push(event.fn.call(target, data));\n          } else {\n            _results.push(void 0);\n          }\n        }\n        return _results;\n      }\n    };\n\n    Event.listen = function(target, type, fn) {\n      var _fn, _type;\n\n      if (typeof target === \"string\") {\n        _type = target;\n        _fn = type;\n        target = null;\n        type = _type;\n        fn = _fn;\n      }\n      if (__indexOf.call(this.types, type) < 0) {\n        return false;\n      }\n      if (!this.events[type]) {\n        this.events[type] = [];\n      }\n      this.events[type].push({\n        target: target,\n        fn: fn\n      });\n      return true;\n    };\n\n    return Event;\n\n  })();\n\n  Event = Caman.Event;\n\n  Caman.Filter = (function() {\n    function Filter() {}\n\n    Filter.Type = {\n      Single: 1,\n      Kernel: 2,\n      LayerDequeue: 3,\n      LayerFinished: 4,\n      LoadOverlay: 5,\n      Plugin: 6\n    };\n\n    Filter.register = function(name, filterFunc) {\n      return Caman.prototype[name] = filterFunc;\n    };\n\n    return Filter;\n\n  })();\n\n  Filter = Caman.Filter;\n\n  Caman.IO = (function() {\n    function IO() {}\n\n    IO.domainRegex = /(?:(?:http|https):\\/\\/)((?:\\w+)\\.(?:(?:\\w|\\.)+))/;\n\n    IO.isRemote = function(img) {\n      if (img == null) {\n        return false;\n      }\n      if (this.corsEnabled(img)) {\n        return false;\n      }\n      return this.isURLRemote(img.src);\n    };\n\n    IO.corsEnabled = function(img) {\n      var _ref;\n\n      return (img.crossOrigin != null) && ((_ref = img.crossOrigin.toLowerCase()) === 'anonymous' || _ref === 'use-credentials');\n    };\n\n    IO.isURLRemote = function(url) {\n      var matches;\n\n      matches = url.match(this.domainRegex);\n      if (matches) {\n        return matches[1] !== document.domain;\n      } else {\n        return false;\n      }\n    };\n\n    IO.remoteCheck = function(src) {\n      if (this.isURLRemote(src)) {\n        if (!Caman.remoteProxy.length) {\n          Log.info(\"Attempting to load a remote image without a configured proxy. URL: \" + src);\n        } else {\n          if (Caman.isURLRemote(Caman.remoteProxy)) {\n            Log.info(\"Cannot use a remote proxy for loading images.\");\n            return;\n          }\n          return this.proxyUrl(src);\n        }\n      }\n    };\n\n    IO.proxyUrl = function(src) {\n      return \"\" + Caman.remoteProxy + \"?\" + Caman.proxyParam + \"=\" + (encodeURIComponent(src));\n    };\n\n    IO.useProxy = function(lang) {\n      var langToExt;\n\n      langToExt = {\n        ruby: 'rb',\n        python: 'py',\n        perl: 'pl',\n        javascript: 'js'\n      };\n      lang = lang.toLowerCase();\n      if (langToExt[lang] != null) {\n        lang = langToExt[lang];\n      }\n      return \"proxies/caman_proxy.\" + lang;\n    };\n\n    return IO;\n\n  })();\n\n  Caman.prototype.save = function() {\n    if (typeof exports !== \"undefined\" && exports !== null) {\n      return this.nodeSave.apply(this, arguments);\n    } else {\n      return this.browserSave.apply(this, arguments);\n    }\n  };\n\n  Caman.prototype.browserSave = function(type) {\n    var image;\n\n    if (type == null) {\n      type = \"png\";\n    }\n    type = type.toLowerCase();\n    image = this.toBase64(type).replace(\"image/\" + type, \"image/octet-stream\");\n    return document.location.href = image;\n  };\n\n  Caman.prototype.nodeSave = function(file, overwrite) {\n    var e, stats;\n\n    if (overwrite == null) {\n      overwrite = true;\n    }\n    try {\n      stats = fs.statSync(file);\n      if (stats.isFile() && !overwrite) {\n        return false;\n      }\n    } catch (_error) {\n      e = _error;\n      Log.debug(\"Creating output file \" + file);\n    }\n    return fs.writeFile(file, this.canvas.toBuffer(), function() {\n      return Log.debug(\"Finished writing to \" + file);\n    });\n  };\n\n  Caman.prototype.toImage = function(type) {\n    var img;\n\n    img = document.createElement('img');\n    img.src = this.toBase64(type);\n    img.width = this.dimensions.width;\n    img.height = this.dimensions.height;\n    if (window.devicePixelRatio) {\n      img.width /= window.devicePixelRatio;\n      img.height /= window.devicePixelRatio;\n    }\n    return img;\n  };\n\n  Caman.prototype.toBase64 = function(type) {\n    if (type == null) {\n      type = \"png\";\n    }\n    type = type.toLowerCase();\n    return this.canvas.toDataURL(\"image/\" + type);\n  };\n\n  IO = Caman.IO;\n\n  Caman.Layer = (function() {\n    function Layer(c) {\n      this.c = c;\n      this.filter = this.c;\n      this.options = {\n        blendingMode: 'normal',\n        opacity: 1.0\n      };\n      this.layerID = Util.uniqid.get();\n      this.canvas = typeof exports !== \"undefined\" && exports !== null ? new Canvas() : document.createElement('canvas');\n      this.canvas.width = this.c.dimensions.width;\n      this.canvas.height = this.c.dimensions.height;\n      this.context = this.canvas.getContext('2d');\n      this.context.createImageData(this.canvas.width, this.canvas.height);\n      this.imageData = this.context.getImageData(0, 0, this.canvas.width, this.canvas.height);\n      this.pixelData = this.imageData.data;\n    }\n\n    Layer.prototype.newLayer = function(cb) {\n      return this.c.newLayer.call(this.c, cb);\n    };\n\n    Layer.prototype.setBlendingMode = function(mode) {\n      this.options.blendingMode = mode;\n      return this;\n    };\n\n    Layer.prototype.opacity = function(opacity) {\n      this.options.opacity = opacity / 100;\n      return this;\n    };\n\n    Layer.prototype.copyParent = function() {\n      var i, parentData, _i, _ref;\n\n      parentData = this.c.pixelData;\n      for (i = _i = 0, _ref = this.c.pixelData.length; _i < _ref; i = _i += 4) {\n        this.pixelData[i] = parentData[i];\n        this.pixelData[i + 1] = parentData[i + 1];\n        this.pixelData[i + 2] = parentData[i + 2];\n        this.pixelData[i + 3] = parentData[i + 3];\n      }\n      return this;\n    };\n\n    Layer.prototype.fillColor = function() {\n      return this.c.fillColor.apply(this.c, arguments);\n    };\n\n    Layer.prototype.overlayImage = function(image) {\n      if (typeof image === \"object\") {\n        image = image.src;\n      } else if (typeof image === \"string\" && image[0] === \"#\") {\n        image = $(image).src;\n      }\n      if (!image) {\n        return this;\n      }\n      this.c.renderer.renderQueue.push({\n        type: Filter.Type.LoadOverlay,\n        src: image,\n        layer: this\n      });\n      return this;\n    };\n\n    Layer.prototype.applyToParent = function() {\n      var i, layerData, parentData, result, rgbaLayer, rgbaParent, _i, _ref, _results;\n\n      parentData = this.c.pixelStack[this.c.pixelStack.length - 1];\n      layerData = this.c.pixelData;\n      _results = [];\n      for (i = _i = 0, _ref = layerData.length; _i < _ref; i = _i += 4) {\n        rgbaParent = {\n          r: parentData[i],\n          g: parentData[i + 1],\n          b: parentData[i + 2],\n          a: parentData[i + 3]\n        };\n        rgbaLayer = {\n          r: layerData[i],\n          g: layerData[i + 1],\n          b: layerData[i + 2],\n          a: layerData[i + 3]\n        };\n        result = Blender.execute(this.options.blendingMode, rgbaLayer, rgbaParent);\n        result.r = Util.clampRGB(result.r);\n        result.g = Util.clampRGB(result.g);\n        result.b = Util.clampRGB(result.b);\n        if (result.a == null) {\n          result.a = rgbaLayer.a;\n        }\n        parentData[i] = rgbaParent.r - ((rgbaParent.r - result.r) * (this.options.opacity * (result.a / 255)));\n        parentData[i + 1] = rgbaParent.g - ((rgbaParent.g - result.g) * (this.options.opacity * (result.a / 255)));\n        _results.push(parentData[i + 2] = rgbaParent.b - ((rgbaParent.b - result.b) * (this.options.opacity * (result.a / 255))));\n      }\n      return _results;\n    };\n\n    return Layer;\n\n  })();\n\n  Layer = Caman.Layer;\n\n  Caman.Logger = (function() {\n    function Logger() {\n      var name, _i, _len, _ref;\n\n      _ref = ['log', 'info', 'warn', 'error'];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        name = _ref[_i];\n        this[name] = (function(name) {\n          return function() {\n            var args, e;\n\n            args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n            if (!Caman.DEBUG) {\n              return;\n            }\n            try {\n              return console[name].apply(console, args);\n            } catch (_error) {\n              e = _error;\n              return console[name](args);\n            }\n          };\n        })(name);\n      }\n      this.debug = this.log;\n    }\n\n    return Logger;\n\n  })();\n\n  Log = new Caman.Logger();\n\n  Caman.Pixel = (function() {\n    Pixel.coordinatesToLocation = function(x, y, width) {\n      return (y * width + x) * 4;\n    };\n\n    Pixel.locationToCoordinates = function(loc, width) {\n      var x, y;\n\n      y = Math.floor(loc / (width * 4));\n      x = (loc % (width * 4)) / 4;\n      return {\n        x: x,\n        y: y\n      };\n    };\n\n    function Pixel(r, g, b, a, c) {\n      this.r = r != null ? r : 0;\n      this.g = g != null ? g : 0;\n      this.b = b != null ? b : 0;\n      this.a = a != null ? a : 255;\n      this.c = c != null ? c : null;\n      this.loc = 0;\n    }\n\n    Pixel.prototype.setContext = function(c) {\n      return this.c = c;\n    };\n\n    Pixel.prototype.locationXY = function() {\n      var x, y;\n\n      if (this.c == null) {\n        throw \"Requires a CamanJS context\";\n      }\n      y = this.c.dimensions.height - Math.floor(this.loc / (this.c.dimensions.width * 4));\n      x = (this.loc % (this.c.dimensions.width * 4)) / 4;\n      return {\n        x: x,\n        y: y\n      };\n    };\n\n    Pixel.prototype.pixelAtLocation = function(loc) {\n      if (this.c == null) {\n        throw \"Requires a CamanJS context\";\n      }\n      return new Pixel(this.c.pixelData[loc], this.c.pixelData[loc + 1], this.c.pixelData[loc + 2], this.c.pixelData[loc + 3], this.c);\n    };\n\n    Pixel.prototype.getPixelRelative = function(horiz, vert) {\n      var newLoc;\n\n      if (this.c == null) {\n        throw \"Requires a CamanJS context\";\n      }\n      newLoc = this.loc + (this.c.dimensions.width * 4 * (vert * -1)) + (4 * horiz);\n      if (newLoc > this.c.pixelData.length || newLoc < 0) {\n        return new Pixel(0, 0, 0, 255, this.c);\n      }\n      return this.pixelAtLocation(newLoc);\n    };\n\n    Pixel.prototype.putPixelRelative = function(horiz, vert, rgba) {\n      var nowLoc;\n\n      if (this.c == null) {\n        throw \"Requires a CamanJS context\";\n      }\n      nowLoc = this.loc + (this.c.dimensions.width * 4 * (vert * -1)) + (4 * horiz);\n      if (newLoc > this.c.pixelData.length || newLoc < 0) {\n        return;\n      }\n      this.c.pixelData[newLoc] = rgba.r;\n      this.c.pixelData[newLoc + 1] = rgba.g;\n      this.c.pixelData[newLoc + 2] = rgba.b;\n      this.c.pixelData[newLoc + 3] = rgba.a;\n      return true;\n    };\n\n    Pixel.prototype.getPixel = function(x, y) {\n      var loc;\n\n      if (this.c == null) {\n        throw \"Requires a CamanJS context\";\n      }\n      loc = this.coordinatesToLocation(x, y, this.width);\n      return this.pixelAtLocation(loc);\n    };\n\n    Pixel.prototype.putPixel = function(x, y, rgba) {\n      var loc;\n\n      if (this.c == null) {\n        throw \"Requires a CamanJS context\";\n      }\n      loc = this.coordinatesToLocation(x, y, this.width);\n      this.c.pixelData[loc] = rgba.r;\n      this.c.pixelData[loc + 1] = rgba.g;\n      this.c.pixelData[loc + 2] = rgba.b;\n      return this.c.pixelData[loc + 3] = rgba.a;\n    };\n\n    Pixel.prototype.toString = function() {\n      return this.toKey();\n    };\n\n    Pixel.prototype.toHex = function(includeAlpha) {\n      var hex;\n\n      if (includeAlpha == null) {\n        includeAlpha = false;\n      }\n      hex = '#' + this.r.toString(16) + this.g.toString(16) + this.b.toString(16);\n      if (includeAlpha) {\n        return hex + this.a.toString(16);\n      } else {\n        return hex;\n      }\n    };\n\n    return Pixel;\n\n  })();\n\n  Pixel = Caman.Pixel;\n\n  Caman.Plugin = (function() {\n    function Plugin() {}\n\n    Plugin.plugins = {};\n\n    Plugin.register = function(name, plugin) {\n      return this.plugins[name] = plugin;\n    };\n\n    Plugin.execute = function(context, name, args) {\n      return this.plugins[name].apply(context, args);\n    };\n\n    return Plugin;\n\n  })();\n\n  Plugin = Caman.Plugin;\n\n  Caman.Renderer = (function() {\n    Renderer.Blocks = Caman.NodeJS ? require('os').cpus().length : 4;\n\n    function Renderer(c) {\n      this.c = c;\n      this.processNext = __bind(this.processNext, this);\n      this.renderQueue = [];\n      this.modPixelData = null;\n    }\n\n    Renderer.prototype.add = function(job) {\n      if (job == null) {\n        return;\n      }\n      return this.renderQueue.push(job);\n    };\n\n    Renderer.prototype.processNext = function() {\n      var layer;\n\n      if (this.renderQueue.length === 0) {\n        Event.trigger(this, \"renderFinished\");\n        if (this.finishedFn != null) {\n          this.finishedFn.call(this.c);\n        }\n        return this;\n      }\n      this.currentJob = this.renderQueue.shift();\n      switch (this.currentJob.type) {\n        case Filter.Type.LayerDequeue:\n          layer = this.c.canvasQueue.shift();\n          this.c.executeLayer(layer);\n          return this.processNext();\n        case Filter.Type.LayerFinished:\n          this.c.applyCurrentLayer();\n          this.c.popContext();\n          return this.processNext();\n        case Filter.Type.LoadOverlay:\n          return this.loadOverlay(this.currentJob.layer, this.currentJob.src);\n        case Filter.Type.Plugin:\n          return this.executePlugin();\n        default:\n          return this.executeFilter();\n      }\n    };\n\n    Renderer.prototype.execute = function(callback) {\n      this.finishedFn = callback;\n      this.modPixelData = Util.dataArray(this.c.pixelData.length);\n      return this.processNext();\n    };\n\n    Renderer.prototype.eachBlock = function(fn) {\n      var blockN, blockPixelLength, bnum, end, f, i, lastBlockN, n, start, _i, _ref, _results,\n        _this = this;\n\n      this.blocksDone = 0;\n      n = this.c.pixelData.length;\n      blockPixelLength = Math.floor((n / 4) / Renderer.Blocks);\n      blockN = blockPixelLength * 4;\n      lastBlockN = blockN + ((n / 4) % Renderer.Blocks) * 4;\n      _results = [];\n      for (i = _i = 0, _ref = Renderer.Blocks; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\n        start = i * blockN;\n        end = start + (i === Renderer.Blocks - 1 ? lastBlockN : blockN);\n        if (Caman.NodeJS) {\n          f = Fiber(function() {\n            return fn.call(_this, i, start, end);\n          });\n          bnum = f.run();\n          _results.push(this.blockFinished(bnum));\n        } else {\n          _results.push(setTimeout((function(i, start, end) {\n            return function() {\n              return fn.call(_this, i, start, end);\n            };\n          })(i, start, end), 0));\n        }\n      }\n      return _results;\n    };\n\n    Renderer.prototype.executeFilter = function() {\n      Event.trigger(this.c, \"processStart\", this.currentJob);\n      if (this.currentJob.type === Filter.Type.Single) {\n        return this.eachBlock(this.renderBlock);\n      } else {\n        return this.eachBlock(this.renderKernel);\n      }\n    };\n\n    Renderer.prototype.executePlugin = function() {\n      Log.debug(\"Executing plugin \" + this.currentJob.plugin);\n      Plugin.execute(this.c, this.currentJob.plugin, this.currentJob.args);\n      Log.debug(\"Plugin \" + this.currentJob.plugin + \" finished!\");\n      return this.processNext();\n    };\n\n    Renderer.prototype.renderBlock = function(bnum, start, end) {\n      var i, pixel, _i;\n\n      Log.debug(\"Block #\" + bnum + \" - Filter: \" + this.currentJob.name + \", Start: \" + start + \", End: \" + end);\n      Event.trigger(this.c, \"blockStarted\", {\n        blockNum: bnum,\n        totalBlocks: Renderer.Blocks,\n        startPixel: start,\n        endPixel: end\n      });\n      pixel = new Pixel();\n      pixel.setContext(this.c);\n      for (i = _i = start; _i < end; i = _i += 4) {\n        pixel.loc = i;\n        pixel.r = this.c.pixelData[i];\n        pixel.g = this.c.pixelData[i + 1];\n        pixel.b = this.c.pixelData[i + 2];\n        pixel.a = this.c.pixelData[i + 3];\n        this.currentJob.processFn(pixel);\n        this.c.pixelData[i] = Util.clampRGB(pixel.r);\n        this.c.pixelData[i + 1] = Util.clampRGB(pixel.g);\n        this.c.pixelData[i + 2] = Util.clampRGB(pixel.b);\n        this.c.pixelData[i + 3] = Util.clampRGB(pixel.a);\n      }\n      if (Caman.NodeJS) {\n        return Fiber[\"yield\"](bnum);\n      } else {\n        return this.blockFinished(bnum);\n      }\n    };\n\n    Renderer.prototype.renderKernel = function(bnum, start, end) {\n      var adjust, adjustSize, bias, builder, builderIndex, divisor, i, j, k, kernel, n, name, p, pixel, res, _i, _j, _k;\n\n      name = this.currentJob.name;\n      bias = this.currentJob.bias;\n      divisor = this.currentJob.divisor;\n      n = this.c.pixelData.length;\n      adjust = this.currentJob.adjust;\n      adjustSize = Math.sqrt(adjust.length);\n      kernel = [];\n      Log.debug(\"Rendering kernel - Filter: \" + this.currentJob.name);\n      start = Math.max(start, this.c.dimensions.width * 4 * ((adjustSize - 1) / 2));\n      end = Math.min(end, n - (this.c.dimensions.width * 4 * ((adjustSize - 1) / 2)));\n      builder = (adjustSize - 1) / 2;\n      pixel = new Pixel();\n      pixel.setContext(this.c);\n      for (i = _i = start; _i < end; i = _i += 4) {\n        pixel.loc = i;\n        builderIndex = 0;\n        for (j = _j = -builder; -builder <= builder ? _j <= builder : _j >= builder; j = -builder <= builder ? ++_j : --_j) {\n          for (k = _k = builder; builder <= -builder ? _k <= -builder : _k >= -builder; k = builder <= -builder ? ++_k : --_k) {\n            p = pixel.getPixelRelative(j, k);\n            kernel[builderIndex * 3] = p.r;\n            kernel[builderIndex * 3 + 1] = p.g;\n            kernel[builderIndex * 3 + 2] = p.b;\n            builderIndex++;\n          }\n        }\n        res = this.processKernel(adjust, kernel, divisor, bias);\n        this.modPixelData[i] = Util.clampRGB(res.r);\n        this.modPixelData[i + 1] = Util.clampRGB(res.g);\n        this.modPixelData[i + 2] = Util.clampRGB(res.b);\n        this.modPixelData[i + 3] = this.c.pixelData[i + 3];\n      }\n      if (Caman.NodeJS) {\n        return Fiber[\"yield\"](bnum);\n      } else {\n        return this.blockFinished(bnum);\n      }\n    };\n\n    Renderer.prototype.blockFinished = function(bnum) {\n      var i, _i, _ref;\n\n      if (bnum >= 0) {\n        Log.debug(\"Block #\" + bnum + \" finished! Filter: \" + this.currentJob.name);\n      }\n      this.blocksDone++;\n      Event.trigger(this.c, \"blockFinished\", {\n        blockNum: bnum,\n        blocksFinished: this.blocksDone,\n        totalBlocks: Renderer.Blocks\n      });\n      if (this.blocksDone === Renderer.Blocks) {\n        if (this.currentJob.type === Filter.Type.Kernel) {\n          for (i = _i = 0, _ref = this.c.pixelData.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\n            this.c.pixelData[i] = this.modPixelData[i];\n          }\n        }\n        if (bnum >= 0) {\n          Log.debug(\"Filter \" + this.currentJob.name + \" finished!\");\n        }\n        Event.trigger(this.c, \"processComplete\", this.currentJob);\n        return this.processNext();\n      }\n    };\n\n    Renderer.prototype.processKernel = function(adjust, kernel, divisor, bias) {\n      var i, val, _i, _ref;\n\n      val = {\n        r: 0,\n        g: 0,\n        b: 0\n      };\n      for (i = _i = 0, _ref = adjust.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\n        val.r += adjust[i] * kernel[i * 3];\n        val.g += adjust[i] * kernel[i * 3 + 1];\n        val.b += adjust[i] * kernel[i * 3 + 2];\n      }\n      val.r = (val.r / divisor) + bias;\n      val.g = (val.g / divisor) + bias;\n      val.b = (val.b / divisor) + bias;\n      return val;\n    };\n\n    Renderer.prototype.loadOverlay = function(layer, src) {\n      var img, proxyUrl,\n        _this = this;\n\n      img = document.createElement('img');\n      img.onload = function() {\n        layer.context.drawImage(img, 0, 0, _this.c.dimensions.width, _this.c.dimensions.height);\n        layer.imageData = layer.context.getImageData(0, 0, _this.c.dimensions.width, _this.c.dimensions.height);\n        layer.pixelData = layer.imageData.data;\n        _this.c.pixelData = layer.pixelData;\n        return _this.processNext();\n      };\n      proxyUrl = IO.remoteCheck(src);\n      return img.src = proxyUrl != null ? proxyUrl : src;\n    };\n\n    return Renderer;\n\n  })();\n\n  Renderer = Caman.Renderer;\n\n  Caman.Store = (function() {\n    function Store() {}\n\n    Store.items = {};\n\n    Store.has = function(search) {\n      return this.items[search] != null;\n    };\n\n    Store.get = function(search) {\n      return this.items[search];\n    };\n\n    Store.put = function(name, obj) {\n      return this.items[name] = obj;\n    };\n\n    Store.execute = function(search, callback) {\n      var _this = this;\n\n      setTimeout(function() {\n        return callback.call(_this.get(search), _this.get(search));\n      }, 0);\n      return this.get(search);\n    };\n\n    Store.flush = function(name) {\n      if (name == null) {\n        name = false;\n      }\n      if (name) {\n        return delete this.items[name];\n      } else {\n        return this.items = {};\n      }\n    };\n\n    return Store;\n\n  })();\n\n  Store = Caman.Store;\n\n  Blender.register(\"normal\", function(rgbaLayer, rgbaParent) {\n    return {\n      r: rgbaLayer.r,\n      g: rgbaLayer.g,\n      b: rgbaLayer.b\n    };\n  });\n\n  Blender.register(\"multiply\", function(rgbaLayer, rgbaParent) {\n    return {\n      r: (rgbaLayer.r * rgbaParent.r) / 255,\n      g: (rgbaLayer.g * rgbaParent.g) / 255,\n      b: (rgbaLayer.b * rgbaParent.b) / 255\n    };\n  });\n\n  Blender.register(\"screen\", function(rgbaLayer, rgbaParent) {\n    return {\n      r: 255 - (((255 - rgbaLayer.r) * (255 - rgbaParent.r)) / 255),\n      g: 255 - (((255 - rgbaLayer.g) * (255 - rgbaParent.g)) / 255),\n      b: 255 - (((255 - rgbaLayer.b) * (255 - rgbaParent.b)) / 255)\n    };\n  });\n\n  Blender.register(\"overlay\", function(rgbaLayer, rgbaParent) {\n    var result;\n\n    result = {};\n    result.r = rgbaParent.r > 128 ? 255 - 2 * (255 - rgbaLayer.r) * (255 - rgbaParent.r) / 255 : (rgbaParent.r * rgbaLayer.r * 2) / 255;\n    result.g = rgbaParent.g > 128 ? 255 - 2 * (255 - rgbaLayer.g) * (255 - rgbaParent.g) / 255 : (rgbaParent.g * rgbaLayer.g * 2) / 255;\n    result.b = rgbaParent.b > 128 ? 255 - 2 * (255 - rgbaLayer.b) * (255 - rgbaParent.b) / 255 : (rgbaParent.b * rgbaLayer.b * 2) / 255;\n    return result;\n  });\n\n  Blender.register(\"difference\", function(rgbaLayer, rgbaParent) {\n    return {\n      r: rgbaLayer.r - rgbaParent.r,\n      g: rgbaLayer.g - rgbaParent.g,\n      b: rgbaLayer.b - rgbaParent.b\n    };\n  });\n\n  Blender.register(\"addition\", function(rgbaLayer, rgbaParent) {\n    return {\n      r: rgbaParent.r + rgbaLayer.r,\n      g: rgbaParent.g + rgbaLayer.g,\n      b: rgbaParent.b + rgbaLayer.b\n    };\n  });\n\n  Blender.register(\"exclusion\", function(rgbaLayer, rgbaParent) {\n    return {\n      r: 128 - 2 * (rgbaParent.r - 128) * (rgbaLayer.r - 128) / 255,\n      g: 128 - 2 * (rgbaParent.g - 128) * (rgbaLayer.g - 128) / 255,\n      b: 128 - 2 * (rgbaParent.b - 128) * (rgbaLayer.b - 128) / 255\n    };\n  });\n\n  Blender.register(\"softLight\", function(rgbaLayer, rgbaParent) {\n    var result;\n\n    result = {};\n    result.r = rgbaParent.r > 128 ? 255 - ((255 - rgbaParent.r) * (255 - (rgbaLayer.r - 128))) / 255 : (rgbaParent.r * (rgbaLayer.r + 128)) / 255;\n    result.g = rgbaParent.g > 128 ? 255 - ((255 - rgbaParent.g) * (255 - (rgbaLayer.g - 128))) / 255 : (rgbaParent.g * (rgbaLayer.g + 128)) / 255;\n    result.b = rgbaParent.b > 128 ? 255 - ((255 - rgbaParent.b) * (255 - (rgbaLayer.b - 128))) / 255 : (rgbaParent.b * (rgbaLayer.b + 128)) / 255;\n    return result;\n  });\n\n  Blender.register(\"lighten\", function(rgbaLayer, rgbaParent) {\n    return {\n      r: rgbaParent.r > rgbaLayer.r ? rgbaParent.r : rgbaLayer.r,\n      g: rgbaParent.g > rgbaLayer.g ? rgbaParent.g : rgbaLayer.g,\n      b: rgbaParent.b > rgbaLayer.b ? rgbaParent.b : rgbaLayer.b\n    };\n  });\n\n  Blender.register(\"darken\", function(rgbaLayer, rgbaParent) {\n    return {\n      r: rgbaParent.r > rgbaLayer.r ? rgbaLayer.r : rgbaParent.r,\n      g: rgbaParent.g > rgbaLayer.g ? rgbaLayer.g : rgbaParent.g,\n      b: rgbaParent.b > rgbaLayer.b ? rgbaLayer.b : rgbaParent.b\n    };\n  });\n\n  Filter.register(\"fillColor\", function() {\n    var color;\n\n    if (arguments.length === 1) {\n      color = Convert.hexToRGB(arguments[0]);\n    } else {\n      color = {\n        r: arguments[0],\n        g: arguments[1],\n        b: arguments[2]\n      };\n    }\n    return this.process(\"fillColor\", function(rgba) {\n      rgba.r = color.r;\n      rgba.g = color.g;\n      rgba.b = color.b;\n      rgba.a = 255;\n      return rgba;\n    });\n  });\n\n  Filter.register(\"brightness\", function(adjust) {\n    adjust = Math.floor(255 * (adjust / 100));\n    return this.process(\"brightness\", function(rgba) {\n      rgba.r += adjust;\n      rgba.g += adjust;\n      rgba.b += adjust;\n      return rgba;\n    });\n  });\n\n  Filter.register(\"saturation\", function(adjust) {\n    adjust *= -0.01;\n    return this.process(\"saturation\", function(rgba) {\n      var max;\n\n      max = Math.max(rgba.r, rgba.g, rgba.b);\n      if (rgba.r !== max) {\n        rgba.r += (max - rgba.r) * adjust;\n      }\n      if (rgba.g !== max) {\n        rgba.g += (max - rgba.g) * adjust;\n      }\n      if (rgba.b !== max) {\n        rgba.b += (max - rgba.b) * adjust;\n      }\n      return rgba;\n    });\n  });\n\n  Filter.register(\"vibrance\", function(adjust) {\n    adjust *= -1;\n    return this.process(\"vibrance\", function(rgba) {\n      var amt, avg, max;\n\n      max = Math.max(rgba.r, rgba.g, rgba.b);\n      avg = (rgba.r + rgba.g + rgba.b) / 3;\n      amt = ((Math.abs(max - avg) * 2 / 255) * adjust) / 100;\n      if (rgba.r !== max) {\n        rgba.r += (max - rgba.r) * amt;\n      }\n      if (rgba.g !== max) {\n        rgba.g += (max - rgba.g) * amt;\n      }\n      if (rgba.b !== max) {\n        rgba.b += (max - rgba.b) * amt;\n      }\n      return rgba;\n    });\n  });\n\n  Filter.register(\"greyscale\", function(adjust) {\n    return this.process(\"greyscale\", function(rgba) {\n      var avg;\n\n      avg = Calculate.luminance(rgba);\n      rgba.r = avg;\n      rgba.g = avg;\n      rgba.b = avg;\n      return rgba;\n    });\n  });\n\n  Filter.register(\"contrast\", function(adjust) {\n    adjust = Math.pow((adjust + 100) / 100, 2);\n    return this.process(\"contrast\", function(rgba) {\n      rgba.r /= 255;\n      rgba.r -= 0.5;\n      rgba.r *= adjust;\n      rgba.r += 0.5;\n      rgba.r *= 255;\n      rgba.g /= 255;\n      rgba.g -= 0.5;\n      rgba.g *= adjust;\n      rgba.g += 0.5;\n      rgba.g *= 255;\n      rgba.b /= 255;\n      rgba.b -= 0.5;\n      rgba.b *= adjust;\n      rgba.b += 0.5;\n      rgba.b *= 255;\n      return rgba;\n    });\n  });\n\n  Filter.register(\"hue\", function(adjust) {\n    return this.process(\"hue\", function(rgba) {\n      var b, g, h, hsv, r, _ref;\n\n      hsv = Convert.rgbToHSV(rgba.r, rgba.g, rgba.b);\n      h = hsv.h * 100;\n      h += Math.abs(adjust);\n      h = h % 100;\n      h /= 100;\n      hsv.h = h;\n      _ref = Convert.hsvToRGB(hsv.h, hsv.s, hsv.v), r = _ref.r, g = _ref.g, b = _ref.b;\n      rgba.r = r;\n      rgba.g = g;\n      rgba.b = b;\n      return rgba;\n    });\n  });\n\n  Filter.register(\"colorize\", function() {\n    var level, rgb;\n\n    if (arguments.length === 2) {\n      rgb = Convert.hexToRGB(arguments[0]);\n      level = arguments[1];\n    } else if (arguments.length === 4) {\n      rgb = {\n        r: arguments[0],\n        g: arguments[1],\n        b: arguments[2]\n      };\n      level = arguments[3];\n    }\n    return this.process(\"colorize\", function(rgba) {\n      rgba.r -= (rgba.r - rgb.r) * (level / 100);\n      rgba.g -= (rgba.g - rgb.g) * (level / 100);\n      rgba.b -= (rgba.b - rgb.b) * (level / 100);\n      return rgba;\n    });\n  });\n\n  Filter.register(\"invert\", function() {\n    return this.process(\"invert\", function(rgba) {\n      rgba.r = 255 - rgba.r;\n      rgba.g = 255 - rgba.g;\n      rgba.b = 255 - rgba.b;\n      return rgba;\n    });\n  });\n\n  Filter.register(\"sepia\", function(adjust) {\n    if (adjust == null) {\n      adjust = 100;\n    }\n    adjust /= 100;\n    return this.process(\"sepia\", function(rgba) {\n      rgba.r = Math.min(255, (rgba.r * (1 - (0.607 * adjust))) + (rgba.g * (0.769 * adjust)) + (rgba.b * (0.189 * adjust)));\n      rgba.g = Math.min(255, (rgba.r * (0.349 * adjust)) + (rgba.g * (1 - (0.314 * adjust))) + (rgba.b * (0.168 * adjust)));\n      rgba.b = Math.min(255, (rgba.r * (0.272 * adjust)) + (rgba.g * (0.534 * adjust)) + (rgba.b * (1 - (0.869 * adjust))));\n      return rgba;\n    });\n  });\n\n  Filter.register(\"gamma\", function(adjust) {\n    return this.process(\"gamma\", function(rgba) {\n      rgba.r = Math.pow(rgba.r / 255, adjust) * 255;\n      rgba.g = Math.pow(rgba.g / 255, adjust) * 255;\n      rgba.b = Math.pow(rgba.b / 255, adjust) * 255;\n      return rgba;\n    });\n  });\n\n  Filter.register(\"noise\", function(adjust) {\n    adjust = Math.abs(adjust) * 2.55;\n    return this.process(\"noise\", function(rgba) {\n      var rand;\n\n      rand = Calculate.randomRange(adjust * -1, adjust);\n      rgba.r += rand;\n      rgba.g += rand;\n      rgba.b += rand;\n      return rgba;\n    });\n  });\n\n  Filter.register(\"clip\", function(adjust) {\n    adjust = Math.abs(adjust) * 2.55;\n    return this.process(\"clip\", function(rgba) {\n      if (rgba.r > 255 - adjust) {\n        rgba.r = 255;\n      } else if (rgba.r < adjust) {\n        rgba.r = 0;\n      }\n      if (rgba.g > 255 - adjust) {\n        rgba.g = 255;\n      } else if (rgba.g < adjust) {\n        rgba.g = 0;\n      }\n      if (rgba.b > 255 - adjust) {\n        rgba.b = 255;\n      } else if (rgba.b < adjust) {\n        rgba.b = 0;\n      }\n      return rgba;\n    });\n  });\n\n  Filter.register(\"channels\", function(options) {\n    var chan, value;\n\n    if (typeof options !== \"object\") {\n      return this;\n    }\n    for (chan in options) {\n      if (!__hasProp.call(options, chan)) continue;\n      value = options[chan];\n      if (value === 0) {\n        delete options[chan];\n        continue;\n      }\n      options[chan] /= 100;\n    }\n    if (options.length === 0) {\n      return this;\n    }\n    return this.process(\"channels\", function(rgba) {\n      if (options.red != null) {\n        if (options.red > 0) {\n          rgba.r += (255 - rgba.r) * options.red;\n        } else {\n          rgba.r -= rgba.r * Math.abs(options.red);\n        }\n      }\n      if (options.green != null) {\n        if (options.green > 0) {\n          rgba.g += (255 - rgba.g) * options.green;\n        } else {\n          rgba.g -= rgba.g * Math.abs(options.green);\n        }\n      }\n      if (options.blue != null) {\n        if (options.blue > 0) {\n          rgba.b += (255 - rgba.b) * options.blue;\n        } else {\n          rgba.b -= rgba.b * Math.abs(options.blue);\n        }\n      }\n      return rgba;\n    });\n  });\n\n  Filter.register(\"curves\", function() {\n    var bezier, chans, cps, ctrl1, ctrl2, end, i, start, _i, _j, _ref, _ref1;\n\n    chans = arguments[0], cps = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n    if (typeof chans === \"string\") {\n      chans = chans.split(\"\");\n    }\n    if (chans[0] === \"v\") {\n      chans = ['r', 'g', 'b'];\n    }\n    if (cps.length < 3 || cps.length > 4) {\n      throw \"Invalid number of arguments to curves filter\";\n    }\n    start = cps[0];\n    ctrl1 = cps[1];\n    ctrl2 = cps.length === 4 ? cps[2] : cps[1];\n    end = cps[cps.length - 1];\n    bezier = Calculate.bezier(start, ctrl1, ctrl2, end, 0, 255);\n    if (start[0] > 0) {\n      for (i = _i = 0, _ref = start[0]; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\n        bezier[i] = start[1];\n      }\n    }\n    if (end[0] < 255) {\n      for (i = _j = _ref1 = end[0]; _ref1 <= 255 ? _j <= 255 : _j >= 255; i = _ref1 <= 255 ? ++_j : --_j) {\n        bezier[i] = end[1];\n      }\n    }\n    return this.process(\"curves\", function(rgba) {\n      var _k, _ref2;\n\n      for (i = _k = 0, _ref2 = chans.length; 0 <= _ref2 ? _k < _ref2 : _k > _ref2; i = 0 <= _ref2 ? ++_k : --_k) {\n        rgba[chans[i]] = bezier[rgba[chans[i]]];\n      }\n      return rgba;\n    });\n  });\n\n  Filter.register(\"exposure\", function(adjust) {\n    var ctrl1, ctrl2, p;\n\n    p = Math.abs(adjust) / 100;\n    ctrl1 = [0, 255 * p];\n    ctrl2 = [255 - (255 * p), 255];\n    if (adjust < 0) {\n      ctrl1 = ctrl1.reverse();\n      ctrl2 = ctrl2.reverse();\n    }\n    return this.curves('rgb', [0, 0], ctrl1, ctrl2, [255, 255]);\n  });\n\n  Caman.Plugin.register(\"crop\", function(width, height, x, y) {\n    var canvas, ctx;\n\n    if (x == null) {\n      x = 0;\n    }\n    if (y == null) {\n      y = 0;\n    }\n    if (typeof exports !== \"undefined\" && exports !== null) {\n      canvas = new Canvas(width, height);\n    } else {\n      canvas = document.createElement('canvas');\n      Util.copyAttributes(this.canvas, canvas);\n      canvas.width = width;\n      canvas.height = height;\n    }\n    ctx = canvas.getContext('2d');\n    ctx.drawImage(this.canvas, x, y, width, height, 0, 0, width, height);\n    this.cropCoordinates = {\n      x: x,\n      y: y\n    };\n    this.cropped = true;\n    return this.replaceCanvas(canvas);\n  });\n\n  Caman.Plugin.register(\"resize\", function(newDims) {\n    var canvas, ctx;\n\n    if (newDims == null) {\n      newDims = null;\n    }\n    if (newDims === null || ((newDims.width == null) && (newDims.height == null))) {\n      Log.error(\"Invalid or missing dimensions given for resize\");\n      return;\n    }\n    if (newDims.width == null) {\n      newDims.width = this.canvas.width * newDims.height / this.canvas.height;\n    } else if (newDims.height == null) {\n      newDims.height = this.canvas.height * newDims.width / this.canvas.width;\n    }\n    if (typeof exports !== \"undefined\" && exports !== null) {\n      canvas = new Canvas(newDims.width, newDims.height);\n    } else {\n      canvas = document.createElement('canvas');\n      Util.copyAttributes(this.canvas, canvas);\n      canvas.width = newDims.width;\n      canvas.height = newDims.height;\n    }\n    ctx = canvas.getContext('2d');\n    ctx.drawImage(this.canvas, 0, 0, this.canvas.width, this.canvas.height, 0, 0, newDims.width, newDims.height);\n    this.resized = true;\n    return this.replaceCanvas(canvas);\n  });\n\n  Caman.Filter.register(\"crop\", function() {\n    return this.processPlugin(\"crop\", Array.prototype.slice.call(arguments, 0));\n  });\n\n  Caman.Filter.register(\"resize\", function() {\n    return this.processPlugin(\"resize\", Array.prototype.slice.call(arguments, 0));\n  });\n\n  Caman.Filter.register(\"boxBlur\", function() {\n    return this.processKernel(\"Box Blur\", [1, 1, 1, 1, 1, 1, 1, 1, 1]);\n  });\n\n  Caman.Filter.register(\"heavyRadialBlur\", function() {\n    return this.processKernel(\"Heavy Radial Blur\", [0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0]);\n  });\n\n  Caman.Filter.register(\"gaussianBlur\", function() {\n    return this.processKernel(\"Gaussian Blur\", [1, 4, 6, 4, 1, 4, 16, 24, 16, 4, 6, 24, 36, 24, 6, 4, 16, 24, 16, 4, 1, 4, 6, 4, 1]);\n  });\n\n  Caman.Filter.register(\"motionBlur\", function(degrees) {\n    var kernel;\n\n    if (degrees === 0 || degrees === 180) {\n      kernel = [0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0];\n    } else if ((degrees > 0 && degrees < 90) || (degrees > 180 && degrees < 270)) {\n      kernel = [0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0];\n    } else if (degrees === 90 || degrees === 270) {\n      kernel = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n    } else {\n      kernel = [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];\n    }\n    return this.processKernel(\"Motion Blur\", kernel);\n  });\n\n  Caman.Filter.register(\"sharpen\", function(amt) {\n    if (amt == null) {\n      amt = 100;\n    }\n    amt /= 100;\n    return this.processKernel(\"Sharpen\", [0, -amt, 0, -amt, 4 * amt + 1, -amt, 0, -amt, 0]);\n  });\n\n  vignetteFilters = {\n    brightness: function(rgba, amt, opts) {\n      rgba.r = rgba.r - (rgba.r * amt * opts.strength);\n      rgba.g = rgba.g - (rgba.g * amt * opts.strength);\n      rgba.b = rgba.b - (rgba.b * amt * opts.strength);\n      return rgba;\n    },\n    gamma: function(rgba, amt, opts) {\n      rgba.r = Math.pow(rgba.r / 255, Math.max(10 * amt * opts.strength, 1)) * 255;\n      rgba.g = Math.pow(rgba.g / 255, Math.max(10 * amt * opts.strength, 1)) * 255;\n      rgba.b = Math.pow(rgba.b / 255, Math.max(10 * amt * opts.strength, 1)) * 255;\n      return rgba;\n    },\n    colorize: function(rgba, amt, opts) {\n      rgba.r -= (rgba.r - opts.color.r) * amt;\n      rgba.g -= (rgba.g - opts.color.g) * amt;\n      rgba.b -= (rgba.b - opts.color.b) * amt;\n      return rgba;\n    }\n  };\n\n  Filter.register(\"vignette\", function(size, strength) {\n    var bezier, center, end, start;\n\n    if (strength == null) {\n      strength = 60;\n    }\n    if (typeof size === \"string\" && size.substr(-1) === \"%\") {\n      if (this.dimensions.height > this.dimensions.width) {\n        size = this.dimensions.width * (parseInt(size.substr(0, size.length - 1), 10) / 100);\n      } else {\n        size = this.dimensions.height * (parseInt(size.substr(0, size.length - 1), 10) / 100);\n      }\n    }\n    strength /= 100;\n    center = [this.dimensions.width / 2, this.dimensions.height / 2];\n    start = Math.sqrt(Math.pow(center[0], 2) + Math.pow(center[1], 2));\n    end = start - size;\n    bezier = Calculate.bezier([0, 1], [30, 30], [70, 60], [100, 80]);\n    return this.process(\"vignette\", function(rgba) {\n      var dist, div, loc;\n\n      loc = rgba.locationXY();\n      dist = Calculate.distance(loc.x, loc.y, center[0], center[1]);\n      if (dist > end) {\n        div = Math.max(1, (bezier[Math.round(((dist - end) / size) * 100)] / 10) * strength);\n        rgba.r = Math.pow(rgba.r / 255, div) * 255;\n        rgba.g = Math.pow(rgba.g / 255, div) * 255;\n        rgba.b = Math.pow(rgba.b / 255, div) * 255;\n      }\n      return rgba;\n    });\n  });\n\n  Filter.register(\"rectangularVignette\", function(opts) {\n    var defaults, dim, percent, size, _i, _len, _ref;\n\n    defaults = {\n      strength: 50,\n      cornerRadius: 0,\n      method: 'brightness',\n      color: {\n        r: 0,\n        g: 0,\n        b: 0\n      }\n    };\n    opts = Util.extend(defaults, opts);\n    if (!opts.size) {\n      return this;\n    } else if (typeof opts.size === \"string\") {\n      percent = parseInt(opts.size, 10) / 100;\n      opts.size = {\n        width: this.dimensions.width * percent,\n        height: this.dimensions.height * percent\n      };\n    } else if (typeof opts.size === \"object\") {\n      _ref = [\"width\", \"height\"];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        dim = _ref[_i];\n        if (typeof opts.size[dim] === \"string\") {\n          opts.size[dim] = this.dimensions[dim] * (parseInt(opts.size[dim], 10) / 100);\n        }\n      }\n    } else if (opts.size === \"number\") {\n      size = opts.size;\n      opts.size = {\n        width: size,\n        height: size\n      };\n    }\n    if (typeof opts.cornerRadius === \"string\") {\n      opts.cornerRadius = (opts.size.width / 2) * (parseInt(opts.cornerRadius, 10) / 100);\n    }\n    opts.strength /= 100;\n    opts.size.width = Math.floor(opts.size.width);\n    opts.size.height = Math.floor(opts.size.height);\n    opts.image = {\n      width: this.dimensions.width,\n      height: this.dimensions.height\n    };\n    if (opts.method === \"colorize\" && typeof opts.color === \"string\") {\n      opts.color = Convert.hexToRGB(opts.color);\n    }\n    opts.coords = {\n      left: (this.dimensions.width - opts.size.width) / 2,\n      right: this.dimensions.width - opts.coords.left,\n      bottom: (this.dimensions.height - opts.size.height) / 2,\n      top: this.dimensions.height - opts.coords.bottom\n    };\n    opts.corners = [\n      {\n        x: opts.coords.left + opts.cornerRadius,\n        y: opts.coords.top - opts.cornerRadius\n      }, {\n        x: opts.coords.right - opts.cornerRadius,\n        y: opts.coords.top - opts.cornerRadius\n      }, {\n        x: opts.coords.right - opts.cornerRadius,\n        y: opts.coords.bottom + opts.cornerRadius\n      }, {\n        x: opts.coords.left + opts.cornerRadius,\n        y: opts.coords.bottom + opts.cornerRadius\n      }\n    ];\n    opts.maxDist = Calculate.distance(0, 0, opts.corners[3].x, opts.corners[3].y) - opts.cornerRadius;\n    return this.process(\"rectangularVignette\", function(rgba) {\n      var amt, loc, radialDist;\n\n      loc = rgba.locationXY();\n      if ((loc.x > opts.corners[0].x && loc.x < opts.corners[1].x) && (loc.y > opts.coords.bottom && loc.y < opts.coords.top)) {\n        return rgba;\n      }\n      if ((loc.x > opts.coords.left && loc.x < opts.coords.right) && (loc.y > opts.corners[3].y && loc.y < opts.corners[2].y)) {\n        return rgba;\n      }\n      if (loc.x > opts.corners[0].x && loc.x < opts.corners[1].x && loc.y > opts.coords.top) {\n        amt = (loc.y - opts.coords.top) / opts.maxDist;\n      } else if (loc.y > opts.corners[2].y && loc.y < opts.corners[1].y && loc.x > opts.coords.right) {\n        amt = (loc.x - opts.coords.right) / opts.maxDist;\n      } else if (loc.x > opts.corners[0].x && loc.x < opts.corners[1].x && loc.y < opts.coords.bottom) {\n        amt = (opts.coords.bottom - loc.y) / opts.maxDist;\n      } else if (loc.y > opts.corners[2].y && loc.y < opts.corners[1].y && loc.x < opts.coords.left) {\n        amt = (opts.coords.left - loc.x) / opts.maxDist;\n      } else if (loc.x <= opts.corners[0].x && loc.y >= opts.corners[0].y) {\n        radialDist = Caman.distance(loc.x, loc.y, opts.corners[0].x, opts.corners[0].y);\n        amt = (radialDist - opts.cornerRadius) / opts.maxDist;\n      } else if (loc.x >= opts.corners[1].x && loc.y >= opts.corners[1].y) {\n        radialDist = Caman.distance(loc.x, loc.y, opts.corners[1].x, opts.corners[1].y);\n        amt = (radialDist - opts.cornerRadius) / opts.maxDist;\n      } else if (loc.x >= opts.corners[2].x && loc.y <= opts.corners[2].y) {\n        radialDist = Caman.distance(loc.x, loc.y, opts.corners[2].x, opts.corners[2].y);\n        amt = (radialDist - opts.cornerRadius) / opts.maxDist;\n      } else if (loc.x <= opts.corners[3].x && loc.y <= opts.corners[3].y) {\n        radialDist = Caman.distance(loc.x, loc.y, opts.corners[3].x, opts.corners[3].y);\n        amt = (radialDist - opts.cornerRadius) / opts.maxDist;\n      }\n      if (amt < 0) {\n        return rgba;\n      }\n      return vignetteFilters[opts.method](rgba, amt, opts);\n    });\n  });\n\n  /*\n  CompoundBlur - Blurring with varying radii for Canvas\n  \n  Version:   0.1\n  Author:  Mario Klingemann\n  Contact:   mario@quasimondo.com\n  Website:  http://www.quasimondo.com/StackBlurForCanvas\n  Twitter:  @quasimondo\n  Modified By: Ryan LeFevre (@meltingice)\n  \n  In case you find this class useful - especially in commercial projects -\n  I am not totally unhappy for a small donation to my PayPal account\n  mario@quasimondo.de\n  \n  Copyright (c) 2011 Mario Klingemann\n  \n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation\n  files (the \"Software\"), to deal in the Software without\n  restriction, including without limitation the rights to use,\n  copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the\n  Software is furnished to do so, subject to the following\n  conditions:\n  \n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n  HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n  WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n  OTHER DEALINGS IN THE SOFTWARE.\n  */\n\n\n  (function() {\n    var BlurStack, getLinearGradientMap, getRadialGradientMap, mul_table, shg_table;\n\n    mul_table = [512, 512, 456, 512, 328, 456, 335, 512, 405, 328, 271, 456, 388, 335, 292, 512, 454, 405, 364, 328, 298, 271, 496, 456, 420, 388, 360, 335, 312, 292, 273, 512, 482, 454, 428, 405, 383, 364, 345, 328, 312, 298, 284, 271, 259, 496, 475, 456, 437, 420, 404, 388, 374, 360, 347, 335, 323, 312, 302, 292, 282, 273, 265, 512, 497, 482, 468, 454, 441, 428, 417, 405, 394, 383, 373, 364, 354, 345, 337, 328, 320, 312, 305, 298, 291, 284, 278, 271, 265, 259, 507, 496, 485, 475, 465, 456, 446, 437, 428, 420, 412, 404, 396, 388, 381, 374, 367, 360, 354, 347, 341, 335, 329, 323, 318, 312, 307, 302, 297, 292, 287, 282, 278, 273, 269, 265, 261, 512, 505, 497, 489, 482, 475, 468, 461, 454, 447, 441, 435, 428, 422, 417, 411, 405, 399, 394, 389, 383, 378, 373, 368, 364, 359, 354, 350, 345, 341, 337, 332, 328, 324, 320, 316, 312, 309, 305, 301, 298, 294, 291, 287, 284, 281, 278, 274, 271, 268, 265, 262, 259, 257, 507, 501, 496, 491, 485, 480, 475, 470, 465, 460, 456, 451, 446, 442, 437, 433, 428, 424, 420, 416, 412, 408, 404, 400, 396, 392, 388, 385, 381, 377, 374, 370, 367, 363, 360, 357, 354, 350, 347, 344, 341, 338, 335, 332, 329, 326, 323, 320, 318, 315, 312, 310, 307, 304, 302, 299, 297, 294, 292, 289, 287, 285, 282, 280, 278, 275, 273, 271, 269, 267, 265, 263, 261, 259];\n    shg_table = [9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24];\n    getLinearGradientMap = function(width, height, centerX, centerY, angle, length, mirrored) {\n      var cnv, context, gradient, x1, x2, y1, y2;\n\n      cnv = typeof exports !== \"undefined\" && exports !== null ? new Canvas() : document.createElement('canvas');\n      cnv.width = width;\n      cnv.height = height;\n      x1 = centerX + Math.cos(angle) * length * 0.5;\n      y1 = centerY + Math.sin(angle) * length * 0.5;\n      x2 = centerX - Math.cos(angle) * length * 0.5;\n      y2 = centerY - Math.sin(angle) * length * 0.5;\n      context = cnv.getContext(\"2d\");\n      gradient = context.createLinearGradient(x1, y1, x2, y2);\n      if (!mirrored) {\n        gradient.addColorStop(0, \"white\");\n        gradient.addColorStop(1, \"black\");\n      } else {\n        gradient.addColorStop(0, \"white\");\n        gradient.addColorStop(0.5, \"black\");\n        gradient.addColorStop(1, \"white\");\n      }\n      context.fillStyle = gradient;\n      context.fillRect(0, 0, width, height);\n      return context.getImageData(0, 0, width, height);\n    };\n    getRadialGradientMap = function(width, height, centerX, centerY, radius1, radius2) {\n      var cnv, context, gradient;\n\n      cnv = typeof exports !== \"undefined\" && exports !== null ? new Canvas() : document.createElement('canvas');\n      cnv.width = width;\n      cnv.height = height;\n      context = cnv.getContext(\"2d\");\n      gradient = context.createRadialGradient(centerX, centerY, radius1, centerX, centerY, radius2);\n      gradient.addColorStop(1, \"white\");\n      gradient.addColorStop(0, \"black\");\n      context.fillStyle = gradient;\n      context.fillRect(0, 0, width, height);\n      return context.getImageData(0, 0, width, height);\n    };\n    BlurStack = function() {\n      this.r = 0;\n      this.g = 0;\n      this.b = 0;\n      this.a = 0;\n      return this.next = null;\n    };\n    Caman.Plugin.register(\"compoundBlur\", function(radiusData, radius, increaseFactor, blurLevels) {\n      var b_in_sum, b_out_sum, b_sum, blend, currentIndex, div, g_in_sum, g_out_sum, g_sum, height, heightMinus1, i, iblend, idx, imagePixels, index, iradius, lookupValue, mul_sum, p, pb, pg, pixels, pr, r_in_sum, r_out_sum, r_sum, radiusPixels, radiusPlus1, rbs, shg_sum, stack, stackEnd, stackIn, stackOut, stackStart, steps, sumFactor, w4, wh, wh4, width, widthMinus1, x, y, yi, yp, yw, _i, _j, _k, _l, _m, _n, _o, _p, _q, _r;\n\n      width = this.dimensions.width;\n      height = this.dimensions.height;\n      imagePixels = this.pixelData;\n      radiusPixels = radiusData.data;\n      wh = width * height;\n      wh4 = wh << 2;\n      pixels = [];\n      for (i = _i = 0; 0 <= wh4 ? _i < wh4 : _i > wh4; i = 0 <= wh4 ? ++_i : --_i) {\n        pixels[i] = imagePixels[i];\n      }\n      currentIndex = 0;\n      steps = blurLevels;\n      blurLevels -= 1;\n      while (steps-- >= 0) {\n        iradius = (radius + 0.5) | 0;\n        if (iradius === 0) {\n          continue;\n        }\n        if (iradius > 256) {\n          iradius = 256;\n        }\n        div = iradius + iradius + 1;\n        w4 = width << 2;\n        widthMinus1 = width - 1;\n        heightMinus1 = height - 1;\n        radiusPlus1 = iradius + 1;\n        sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;\n        stackStart = new BlurStack();\n        stackEnd = void 0;\n        stack = stackStart;\n        for (i = _j = 1; 1 <= div ? _j < div : _j > div; i = 1 <= div ? ++_j : --_j) {\n          stack = stack.next = new BlurStack();\n          if (i === radiusPlus1) {\n            stackEnd = stack;\n          }\n        }\n        stack.next = stackStart;\n        stackIn = null;\n        stackOut = null;\n        yw = yi = 0;\n        mul_sum = mul_table[iradius];\n        shg_sum = shg_table[iradius];\n        for (y = _k = 0; 0 <= height ? _k < height : _k > height; y = 0 <= height ? ++_k : --_k) {\n          r_in_sum = g_in_sum = b_in_sum = r_sum = g_sum = b_sum = 0;\n          r_out_sum = radiusPlus1 * (pr = pixels[yi]);\n          g_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);\n          b_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);\n          r_sum += sumFactor * pr;\n          g_sum += sumFactor * pg;\n          b_sum += sumFactor * pb;\n          stack = stackStart;\n          for (i = _l = 0; 0 <= radiusPlus1 ? _l < radiusPlus1 : _l > radiusPlus1; i = 0 <= radiusPlus1 ? ++_l : --_l) {\n            stack.r = pr;\n            stack.g = pg;\n            stack.b = pb;\n            stack = stack.next;\n          }\n          for (i = _m = 1; 1 <= radiusPlus1 ? _m < radiusPlus1 : _m > radiusPlus1; i = 1 <= radiusPlus1 ? ++_m : --_m) {\n            p = yi + ((widthMinus1 < i ? widthMinus1 : i) << 2);\n            r_sum += (stack.r = (pr = pixels[p])) * (rbs = radiusPlus1 - i);\n            g_sum += (stack.g = (pg = pixels[p + 1])) * rbs;\n            b_sum += (stack.b = (pb = pixels[p + 2])) * rbs;\n            r_in_sum += pr;\n            g_in_sum += pg;\n            b_in_sum += pb;\n            stack = stack.next;\n          }\n          stackIn = stackStart;\n          stackOut = stackEnd;\n          for (x = _n = 0; 0 <= width ? _n < width : _n > width; x = 0 <= width ? ++_n : --_n) {\n            pixels[yi] = (r_sum * mul_sum) >> shg_sum;\n            pixels[yi + 1] = (g_sum * mul_sum) >> shg_sum;\n            pixels[yi + 2] = (b_sum * mul_sum) >> shg_sum;\n            r_sum -= r_out_sum;\n            g_sum -= g_out_sum;\n            b_sum -= b_out_sum;\n            r_out_sum -= stackIn.r;\n            g_out_sum -= stackIn.g;\n            b_out_sum -= stackIn.b;\n            p = (yw + ((p = x + radiusPlus1) < widthMinus1 ? p : widthMinus1)) << 2;\n            r_in_sum += (stackIn.r = pixels[p]);\n            g_in_sum += (stackIn.g = pixels[p + 1]);\n            b_in_sum += (stackIn.b = pixels[p + 2]);\n            r_sum += r_in_sum;\n            g_sum += g_in_sum;\n            b_sum += b_in_sum;\n            stackIn = stackIn.next;\n            r_out_sum += (pr = stackOut.r);\n            g_out_sum += (pg = stackOut.g);\n            b_out_sum += (pb = stackOut.b);\n            r_in_sum -= pr;\n            g_in_sum -= pg;\n            b_in_sum -= pb;\n            stackOut = stackOut.next;\n            yi += 4;\n          }\n          yw += width;\n        }\n        for (x = _o = 0; 0 <= width ? _o < width : _o > width; x = 0 <= width ? ++_o : --_o) {\n          g_in_sum = b_in_sum = r_in_sum = g_sum = b_sum = r_sum = 0;\n          yi = x << 2;\n          r_out_sum = radiusPlus1 * (pr = pixels[yi]);\n          g_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);\n          b_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);\n          r_sum += sumFactor * pr;\n          g_sum += sumFactor * pg;\n          b_sum += sumFactor * pb;\n          stack = stackStart;\n          for (i = _p = 0; 0 <= radiusPlus1 ? _p < radiusPlus1 : _p > radiusPlus1; i = 0 <= radiusPlus1 ? ++_p : --_p) {\n            stack.r = pr;\n            stack.g = pg;\n            stack.b = pb;\n            stack = stack.next;\n          }\n          yp = width;\n          for (i = _q = 1; 1 <= radiusPlus1 ? _q < radiusPlus1 : _q > radiusPlus1; i = 1 <= radiusPlus1 ? ++_q : --_q) {\n            yi = (yp + x) << 2;\n            r_sum += (stack.r = (pr = pixels[yi])) * (rbs = radiusPlus1 - i);\n            g_sum += (stack.g = (pg = pixels[yi + 1])) * rbs;\n            b_sum += (stack.b = (pb = pixels[yi + 2])) * rbs;\n            r_in_sum += pr;\n            g_in_sum += pg;\n            b_in_sum += pb;\n            stack = stack.next;\n            if (i < heightMinus1) {\n              yp += width;\n            }\n          }\n          yi = x;\n          stackIn = stackStart;\n          stackOut = stackEnd;\n          for (y = _r = 0; 0 <= height ? _r < height : _r > height; y = 0 <= height ? ++_r : --_r) {\n            p = yi << 2;\n            pixels[p] = (r_sum * mul_sum) >> shg_sum;\n            pixels[p + 1] = (g_sum * mul_sum) >> shg_sum;\n            pixels[p + 2] = (b_sum * mul_sum) >> shg_sum;\n            r_sum -= r_out_sum;\n            g_sum -= g_out_sum;\n            b_sum -= b_out_sum;\n            r_out_sum -= stackIn.r;\n            g_out_sum -= stackIn.g;\n            b_out_sum -= stackIn.b;\n            p = (x + (((p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width)) << 2;\n            r_sum += (r_in_sum += (stackIn.r = pixels[p]));\n            g_sum += (g_in_sum += (stackIn.g = pixels[p + 1]));\n            b_sum += (b_in_sum += (stackIn.b = pixels[p + 2]));\n            stackIn = stackIn.next;\n            r_out_sum += (pr = stackOut.r);\n            g_out_sum += (pg = stackOut.g);\n            b_out_sum += (pb = stackOut.b);\n            r_in_sum -= pr;\n            g_in_sum -= pg;\n            b_in_sum -= pb;\n            stackOut = stackOut.next;\n            yi += width;\n          }\n        }\n        radius *= increaseFactor;\n        i = wh;\n        while (--i > -1) {\n          idx = i << 2;\n          lookupValue = (radiusPixels[idx + 2] & 0xff) / 255.0 * blurLevels;\n          index = lookupValue | 0;\n          if (index === currentIndex) {\n            blend = 256.0 * (lookupValue - (lookupValue | 0));\n            iblend = 256 - blend;\n            imagePixels[idx] = (imagePixels[idx] * iblend + pixels[idx] * blend) >> 8;\n            imagePixels[idx + 1] = (imagePixels[idx + 1] * iblend + pixels[idx + 1] * blend) >> 8;\n            imagePixels[idx + 2] = (imagePixels[idx + 2] * iblend + pixels[idx + 2] * blend) >> 8;\n          } else if (index === currentIndex + 1) {\n            imagePixels[idx] = pixels[idx];\n            imagePixels[idx + 1] = pixels[idx + 1];\n            imagePixels[idx + 2] = pixels[idx + 2];\n          }\n        }\n        currentIndex++;\n      }\n      return this;\n    });\n    Caman.Filter.register(\"tiltShift\", function(opts) {\n      var defaults, gradient;\n\n      defaults = {\n        center: {\n          x: this.dimensions.width / 2,\n          y: this.dimensions.height / 2\n        },\n        angle: 45,\n        focusWidth: 200,\n        startRadius: 3,\n        radiusFactor: 1.5,\n        steps: 3\n      };\n      opts = Util.extend(defaults, opts);\n      opts.angle *= Math.PI / 180;\n      gradient = getLinearGradientMap(this.dimensions.width, this.dimensions.height, opts.center.x, opts.center.y, opts.angle, opts.focusWidth, true);\n      return this.processPlugin(\"compoundBlur\", [gradient, opts.startRadius, opts.radiusFactor, opts.steps]);\n    });\n    return Caman.Filter.register(\"radialBlur\", function(opts) {\n      var defaults, gradient, radius1, radius2;\n\n      defaults = {\n        size: 50,\n        center: {\n          x: this.dimensions.width / 2,\n          y: this.dimensions.height / 2\n        },\n        startRadius: 3,\n        radiusFactor: 1.5,\n        steps: 3,\n        radius: null\n      };\n      opts = Util.extend(defaults, opts);\n      if (!opts.radius) {\n        opts.radius = this.dimensions.width < this.dimensions.height ? this.dimensions.height : this.dimensions.width;\n      }\n      radius1 = (opts.radius / 2) - opts.size;\n      radius2 = opts.radius / 2;\n      gradient = getRadialGradientMap(this.dimensions.width, this.dimensions.height, opts.center.x, opts.center.y, radius1, radius2);\n      return this.processPlugin(\"compoundBlur\", [gradient, opts.startRadius, opts.radiusFactor, opts.steps]);\n    });\n  })();\n\n  Caman.Filter.register(\"edgeEnhance\", function() {\n    return this.processKernel(\"Edge Enhance\", [0, 0, 0, -1, 1, 0, 0, 0, 0]);\n  });\n\n  Caman.Filter.register(\"edgeDetect\", function() {\n    return this.processKernel(\"Edge Detect\", [-1, -1, -1, -1, 8, -1, -1, -1, -1]);\n  });\n\n  Caman.Filter.register(\"emboss\", function() {\n    return this.processKernel(\"Emboss\", [-2, -1, 0, -1, 1, 1, 0, 1, 2]);\n  });\n\n  Caman.Filter.register(\"posterize\", function(adjust) {\n    var numOfAreas, numOfValues;\n\n    numOfAreas = 256 / adjust;\n    numOfValues = 255 / (adjust - 1);\n    return this.process(\"posterize\", function(rgba) {\n      rgba.r = Math.floor(Math.floor(rgba.r / numOfAreas) * numOfValues);\n      rgba.g = Math.floor(Math.floor(rgba.g / numOfAreas) * numOfValues);\n      rgba.b = Math.floor(Math.floor(rgba.b / numOfAreas) * numOfValues);\n      return rgba;\n    });\n  });\n\n  Caman.Filter.register(\"vintage\", function(vignette) {\n    if (vignette == null) {\n      vignette = true;\n    }\n    this.greyscale();\n    this.contrast(5);\n    this.noise(3);\n    this.sepia(100);\n    this.channels({\n      red: 8,\n      blue: 2,\n      green: 4\n    });\n    this.gamma(0.87);\n    if (vignette) {\n      return this.vignette(\"40%\", 30);\n    }\n  });\n\n  Caman.Filter.register(\"lomo\", function(vignette) {\n    if (vignette == null) {\n      vignette = true;\n    }\n    this.brightness(15);\n    this.exposure(15);\n    this.curves('rgb', [0, 0], [200, 0], [155, 255], [255, 255]);\n    this.saturation(-20);\n    this.gamma(1.8);\n    if (vignette) {\n      this.vignette(\"50%\", 60);\n    }\n    return this.brightness(5);\n  });\n\n  Caman.Filter.register(\"clarity\", function(grey) {\n    if (grey == null) {\n      grey = false;\n    }\n    this.vibrance(20);\n    this.curves('rgb', [5, 0], [130, 150], [190, 220], [250, 255]);\n    this.sharpen(15);\n    this.vignette(\"45%\", 20);\n    if (grey) {\n      this.greyscale();\n      this.contrast(4);\n    }\n    return this;\n  });\n\n  Caman.Filter.register(\"sinCity\", function() {\n    this.contrast(100);\n    this.brightness(15);\n    this.exposure(10);\n    this.posterize(80);\n    this.clip(30);\n    return this.greyscale();\n  });\n\n  Caman.Filter.register(\"sunrise\", function() {\n    this.exposure(3.5);\n    this.saturation(-5);\n    this.vibrance(50);\n    this.sepia(60);\n    this.colorize(\"#e87b22\", 10);\n    this.channels({\n      red: 8,\n      blue: 8\n    });\n    this.contrast(5);\n    this.gamma(1.2);\n    return this.vignette(\"55%\", 25);\n  });\n\n  Caman.Filter.register(\"crossProcess\", function() {\n    this.exposure(5);\n    this.colorize(\"#e87b22\", 4);\n    this.sepia(20);\n    this.channels({\n      blue: 8,\n      red: 3\n    });\n    this.curves('b', [0, 0], [100, 150], [180, 180], [255, 255]);\n    this.contrast(15);\n    this.vibrance(75);\n    return this.gamma(1.6);\n  });\n\n  Caman.Filter.register(\"orangePeel\", function() {\n    this.curves('rgb', [0, 0], [100, 50], [140, 200], [255, 255]);\n    this.vibrance(-30);\n    this.saturation(-30);\n    this.colorize('#ff9000', 30);\n    this.contrast(-5);\n    return this.gamma(1.4);\n  });\n\n  Caman.Filter.register(\"love\", function() {\n    this.brightness(5);\n    this.exposure(8);\n    this.contrast(4);\n    this.colorize('#c42007', 30);\n    this.vibrance(50);\n    return this.gamma(1.3);\n  });\n\n  Caman.Filter.register(\"grungy\", function() {\n    this.gamma(1.5);\n    this.clip(25);\n    this.saturation(-60);\n    this.contrast(5);\n    this.noise(5);\n    return this.vignette(\"50%\", 30);\n  });\n\n  Caman.Filter.register(\"jarques\", function() {\n    this.saturation(-35);\n    this.curves('b', [20, 0], [90, 120], [186, 144], [255, 230]);\n    this.curves('r', [0, 0], [144, 90], [138, 120], [255, 255]);\n    this.curves('g', [10, 0], [115, 105], [148, 100], [255, 248]);\n    this.curves('rgb', [0, 0], [120, 100], [128, 140], [255, 255]);\n    return this.sharpen(20);\n  });\n\n  Caman.Filter.register(\"pinhole\", function() {\n    this.greyscale();\n    this.sepia(10);\n    this.exposure(10);\n    this.contrast(15);\n    return this.vignette(\"60%\", 35);\n  });\n\n  Caman.Filter.register(\"oldBoot\", function() {\n    this.saturation(-20);\n    this.vibrance(-50);\n    this.gamma(1.1);\n    this.sepia(30);\n    this.channels({\n      red: -10,\n      blue: 5\n    });\n    this.curves('rgb', [0, 0], [80, 50], [128, 230], [255, 255]);\n    return this.vignette(\"60%\", 30);\n  });\n\n  Caman.Filter.register(\"glowingSun\", function(vignette) {\n    if (vignette == null) {\n      vignette = true;\n    }\n    this.brightness(10);\n    this.newLayer(function() {\n      this.setBlendingMode(\"multiply\");\n      this.opacity(80);\n      this.copyParent();\n      this.filter.gamma(0.8);\n      this.filter.contrast(50);\n      return this.filter.exposure(10);\n    });\n    this.newLayer(function() {\n      this.setBlendingMode(\"softLight\");\n      this.opacity(80);\n      return this.fillColor(\"#f49600\");\n    });\n    this.exposure(20);\n    this.gamma(0.8);\n    if (vignette) {\n      return this.vignette(\"45%\", 20);\n    }\n  });\n\n  Caman.Filter.register(\"hazyDays\", function() {\n    this.gamma(1.2);\n    this.newLayer(function() {\n      this.setBlendingMode(\"overlay\");\n      this.opacity(60);\n      this.copyParent();\n      this.filter.channels({\n        red: 5\n      });\n      return this.filter.stackBlur(15);\n    });\n    this.newLayer(function() {\n      this.setBlendingMode(\"addition\");\n      this.opacity(40);\n      return this.fillColor(\"#6899ba\");\n    });\n    this.newLayer(function() {\n      this.setBlendingMode(\"multiply\");\n      this.opacity(35);\n      this.copyParent();\n      this.filter.brightness(40);\n      this.filter.vibrance(40);\n      this.filter.exposure(30);\n      this.filter.contrast(15);\n      this.filter.curves('r', [0, 40], [128, 128], [128, 128], [255, 215]);\n      this.filter.curves('g', [0, 40], [128, 128], [128, 128], [255, 215]);\n      this.filter.curves('b', [0, 40], [128, 128], [128, 128], [255, 215]);\n      return this.filter.stackBlur(5);\n    });\n    this.curves('r', [20, 0], [128, 158], [128, 128], [235, 255]);\n    this.curves('g', [20, 0], [128, 128], [128, 128], [235, 255]);\n    this.curves('b', [20, 0], [128, 108], [128, 128], [235, 255]);\n    return this.vignette(\"45%\", 20);\n  });\n\n  Caman.Filter.register(\"herMajesty\", function() {\n    this.brightness(40);\n    this.colorize(\"#ea1c5d\", 10);\n    this.curves('b', [0, 10], [128, 180], [190, 190], [255, 255]);\n    this.newLayer(function() {\n      this.setBlendingMode('overlay');\n      this.opacity(50);\n      this.copyParent();\n      this.filter.gamma(0.7);\n      return this.newLayer(function() {\n        this.setBlendingMode('normal');\n        this.opacity(60);\n        return this.fillColor('#ea1c5d');\n      });\n    });\n    this.newLayer(function() {\n      this.setBlendingMode('multiply');\n      this.opacity(60);\n      this.copyParent();\n      this.filter.saturation(50);\n      this.filter.hue(90);\n      return this.filter.contrast(10);\n    });\n    this.gamma(1.4);\n    this.vibrance(-30);\n    this.newLayer(function() {\n      this.opacity(10);\n      return this.fillColor('#e5f0ff');\n    });\n    return this;\n  });\n\n  Caman.Filter.register(\"nostalgia\", function() {\n    this.saturation(20);\n    this.gamma(1.4);\n    this.greyscale();\n    this.contrast(5);\n    this.sepia(100);\n    this.channels({\n      red: 8,\n      blue: 2,\n      green: 4\n    });\n    this.gamma(0.8);\n    this.contrast(5);\n    this.exposure(10);\n    this.newLayer(function() {\n      this.setBlendingMode('overlay');\n      this.copyParent();\n      this.opacity(55);\n      return this.filter.stackBlur(10);\n    });\n    return this.vignette(\"50%\", 30);\n  });\n\n  Caman.Filter.register(\"hemingway\", function() {\n    this.greyscale();\n    this.contrast(10);\n    this.gamma(0.9);\n    this.newLayer(function() {\n      this.setBlendingMode(\"multiply\");\n      this.opacity(40);\n      this.copyParent();\n      this.filter.exposure(15);\n      this.filter.contrast(15);\n      return this.filter.channels({\n        green: 10,\n        red: 5\n      });\n    });\n    this.sepia(30);\n    this.curves('rgb', [0, 10], [120, 90], [180, 200], [235, 255]);\n    this.channels({\n      red: 5,\n      green: -2\n    });\n    return this.exposure(15);\n  });\n\n  Caman.Filter.register(\"concentrate\", function() {\n    this.sharpen(40);\n    this.saturation(-50);\n    this.channels({\n      red: 3\n    });\n    this.newLayer(function() {\n      this.setBlendingMode(\"multiply\");\n      this.opacity(80);\n      this.copyParent();\n      this.filter.sharpen(5);\n      this.filter.contrast(50);\n      this.filter.exposure(10);\n      return this.filter.channels({\n        blue: 5\n      });\n    });\n    return this.brightness(10);\n  });\n\n  Caman.Plugin.register(\"rotate\", function(degrees) {\n    var angle, canvas, ctx, height, to_radians, width, x, y;\n\n    angle = degrees % 360;\n    if (angle === 0) {\n      return this.dimensions = {\n        width: this.canvas.width,\n        height: this.canvas.height\n      };\n    }\n    to_radians = Math.PI / 180;\n    if (typeof exports !== \"undefined\" && exports !== null) {\n      canvas = new Canvas();\n    } else {\n      canvas = document.createElement('canvas');\n      Util.copyAttributes(this.canvas, canvas);\n    }\n    if (angle === 90 || angle === -270 || angle === 270 || angle === -90) {\n      width = this.canvas.height;\n      height = this.canvas.width;\n      x = width / 2;\n      y = height / 2;\n    } else if (angle === 180) {\n      width = this.canvas.width;\n      height = this.canvas.height;\n      x = width / 2;\n      y = height / 2;\n    } else {\n      width = Math.sqrt(Math.pow(this.originalWidth, 2) + Math.pow(this.originalHeight, 2));\n      height = width;\n      x = this.canvas.height / 2;\n      y = this.canvas.width / 2;\n    }\n    canvas.width = width;\n    canvas.height = height;\n    ctx = canvas.getContext('2d');\n    ctx.save();\n    ctx.translate(x, y);\n    ctx.rotate(angle * to_radians);\n    ctx.drawImage(this.canvas, -this.canvas.width / 2, -this.canvas.height / 2, this.canvas.width, this.canvas.height);\n    ctx.restore();\n    return this.replaceCanvas(canvas);\n  });\n\n  Caman.Filter.register(\"rotate\", function() {\n    return this.processPlugin(\"rotate\", Array.prototype.slice.call(arguments, 0));\n  });\n\n  /*\n  StackBlur - a fast almost Gaussian Blur For Canvas v0.31 modified for CamanJS\n  \n  Version:   0.31\n  Author:    Mario Klingemann\n  Contact:   mario@quasimondo.com\n  Website:  http://www.quasimondo.com/StackBlurForCanvas\n  Twitter:  @quasimondo\n  Modified By: Ryan LeFevre (@meltingice)\n  \n  In case you find this class useful - especially in commercial projects -\n  I am not totally unhappy for a small donation to my PayPal account\n  mario@quasimondo.de\n  \n  Or support me on flattr: \n  https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript\n  \n  Copyright (c) 2010 Mario Klingemann\n  \n  Permission is hereby granted, free of charge, to any person\n  obtaining a copy of this software and associated documentation\n  files (the \"Software\"), to deal in the Software without\n  restriction, including without limitation the rights to use,\n  copy, modify, merge, publish, distribute, sublicense, and/or sell\n  copies of the Software, and to permit persons to whom the\n  Software is furnished to do so, subject to the following\n  conditions:\n  \n  The above copyright notice and this permission notice shall be\n  included in all copies or substantial portions of the Software.\n  \n  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n  HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n  WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n  OTHER DEALINGS IN THE SOFTWARE.\n  */\n\n\n  (function() {\n    var BlurStack, mul_table, shg_table;\n\n    mul_table = [512, 512, 456, 512, 328, 456, 335, 512, 405, 328, 271, 456, 388, 335, 292, 512, 454, 405, 364, 328, 298, 271, 496, 456, 420, 388, 360, 335, 312, 292, 273, 512, 482, 454, 428, 405, 383, 364, 345, 328, 312, 298, 284, 271, 259, 496, 475, 456, 437, 420, 404, 388, 374, 360, 347, 335, 323, 312, 302, 292, 282, 273, 265, 512, 497, 482, 468, 454, 441, 428, 417, 405, 394, 383, 373, 364, 354, 345, 337, 328, 320, 312, 305, 298, 291, 284, 278, 271, 265, 259, 507, 496, 485, 475, 465, 456, 446, 437, 428, 420, 412, 404, 396, 388, 381, 374, 367, 360, 354, 347, 341, 335, 329, 323, 318, 312, 307, 302, 297, 292, 287, 282, 278, 273, 269, 265, 261, 512, 505, 497, 489, 482, 475, 468, 461, 454, 447, 441, 435, 428, 422, 417, 411, 405, 399, 394, 389, 383, 378, 373, 368, 364, 359, 354, 350, 345, 341, 337, 332, 328, 324, 320, 316, 312, 309, 305, 301, 298, 294, 291, 287, 284, 281, 278, 274, 271, 268, 265, 262, 259, 257, 507, 501, 496, 491, 485, 480, 475, 470, 465, 460, 456, 451, 446, 442, 437, 433, 428, 424, 420, 416, 412, 408, 404, 400, 396, 392, 388, 385, 381, 377, 374, 370, 367, 363, 360, 357, 354, 350, 347, 344, 341, 338, 335, 332, 329, 326, 323, 320, 318, 315, 312, 310, 307, 304, 302, 299, 297, 294, 292, 289, 287, 285, 282, 280, 278, 275, 273, 271, 269, 267, 265, 263, 261, 259];\n    shg_table = [9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24];\n    BlurStack = function() {\n      this.r = 0;\n      this.g = 0;\n      this.b = 0;\n      this.a = 0;\n      return this.next = null;\n    };\n    Caman.Plugin.register(\"stackBlur\", function(radius) {\n      var b_in_sum, b_out_sum, b_sum, div, g_in_sum, g_out_sum, g_sum, height, heightMinus1, i, mul_sum, p, pb, pg, pixels, pr, r_in_sum, r_out_sum, r_sum, radiusPlus1, rbs, shg_sum, stack, stackEnd, stackIn, stackOut, stackStart, sumFactor, w4, width, widthMinus1, x, y, yi, yp, yw, _i, _j, _k, _l, _m, _n, _o, _p, _q;\n\n      if (isNaN(radius) || radius < 1) {\n        return;\n      }\n      radius |= 0;\n      pixels = this.pixelData;\n      width = this.dimensions.width;\n      height = this.dimensions.height;\n      div = radius + radius + 1;\n      w4 = width << 2;\n      widthMinus1 = width - 1;\n      heightMinus1 = height - 1;\n      radiusPlus1 = radius + 1;\n      sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;\n      stackStart = new BlurStack();\n      stack = stackStart;\n      for (i = _i = 1; 1 <= div ? _i < div : _i > div; i = 1 <= div ? ++_i : --_i) {\n        stack = stack.next = new BlurStack();\n        if (i === radiusPlus1) {\n          stackEnd = stack;\n        }\n      }\n      stack.next = stackStart;\n      stackIn = null;\n      stackOut = null;\n      yw = yi = 0;\n      mul_sum = mul_table[radius];\n      shg_sum = shg_table[radius];\n      for (y = _j = 0; 0 <= height ? _j < height : _j > height; y = 0 <= height ? ++_j : --_j) {\n        r_in_sum = g_in_sum = b_in_sum = r_sum = g_sum = b_sum = 0;\n        r_out_sum = radiusPlus1 * (pr = pixels[yi]);\n        g_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);\n        b_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);\n        r_sum += sumFactor * pr;\n        g_sum += sumFactor * pg;\n        b_sum += sumFactor * pb;\n        stack = stackStart;\n        for (i = _k = 0; 0 <= radiusPlus1 ? _k < radiusPlus1 : _k > radiusPlus1; i = 0 <= radiusPlus1 ? ++_k : --_k) {\n          stack.r = pr;\n          stack.g = pg;\n          stack.b = pb;\n          stack = stack.next;\n        }\n        for (i = _l = 1; 1 <= radiusPlus1 ? _l < radiusPlus1 : _l > radiusPlus1; i = 1 <= radiusPlus1 ? ++_l : --_l) {\n          p = yi + ((widthMinus1 < i ? widthMinus1 : i) << 2);\n          r_sum += (stack.r = (pr = pixels[p])) * (rbs = radiusPlus1 - i);\n          g_sum += (stack.g = (pg = pixels[p + 1])) * rbs;\n          b_sum += (stack.b = (pb = pixels[p + 2])) * rbs;\n          r_in_sum += pr;\n          g_in_sum += pg;\n          b_in_sum += pb;\n          stack = stack.next;\n        }\n        stackIn = stackStart;\n        stackOut = stackEnd;\n        for (x = _m = 0; 0 <= width ? _m < width : _m > width; x = 0 <= width ? ++_m : --_m) {\n          pixels[yi] = (r_sum * mul_sum) >> shg_sum;\n          pixels[yi + 1] = (g_sum * mul_sum) >> shg_sum;\n          pixels[yi + 2] = (b_sum * mul_sum) >> shg_sum;\n          r_sum -= r_out_sum;\n          g_sum -= g_out_sum;\n          b_sum -= b_out_sum;\n          r_out_sum -= stackIn.r;\n          g_out_sum -= stackIn.g;\n          b_out_sum -= stackIn.b;\n          p = (yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1)) << 2;\n          r_in_sum += (stackIn.r = pixels[p]);\n          g_in_sum += (stackIn.g = pixels[p + 1]);\n          b_in_sum += (stackIn.b = pixels[p + 2]);\n          r_sum += r_in_sum;\n          g_sum += g_in_sum;\n          b_sum += b_in_sum;\n          stackIn = stackIn.next;\n          r_out_sum += (pr = stackOut.r);\n          g_out_sum += (pg = stackOut.g);\n          b_out_sum += (pb = stackOut.b);\n          r_in_sum -= pr;\n          g_in_sum -= pg;\n          b_in_sum -= pb;\n          stackOut = stackOut.next;\n          yi += 4;\n        }\n        yw += width;\n      }\n      for (x = _n = 0; 0 <= width ? _n < width : _n > width; x = 0 <= width ? ++_n : --_n) {\n        g_in_sum = b_in_sum = r_in_sum = g_sum = b_sum = r_sum = 0;\n        yi = x << 2;\n        r_out_sum = radiusPlus1 * (pr = pixels[yi]);\n        g_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);\n        b_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);\n        r_sum += sumFactor * pr;\n        g_sum += sumFactor * pg;\n        b_sum += sumFactor * pb;\n        stack = stackStart;\n        for (i = _o = 0; 0 <= radiusPlus1 ? _o < radiusPlus1 : _o > radiusPlus1; i = 0 <= radiusPlus1 ? ++_o : --_o) {\n          stack.r = pr;\n          stack.g = pg;\n          stack.b = pb;\n          stack = stack.next;\n        }\n        yp = width;\n        for (i = _p = 1; 1 <= radius ? _p <= radius : _p >= radius; i = 1 <= radius ? ++_p : --_p) {\n          yi = (yp + x) << 2;\n          r_sum += (stack.r = (pr = pixels[yi])) * (rbs = radiusPlus1 - i);\n          g_sum += (stack.g = (pg = pixels[yi + 1])) * rbs;\n          b_sum += (stack.b = (pb = pixels[yi + 2])) * rbs;\n          r_in_sum += pr;\n          g_in_sum += pg;\n          b_in_sum += pb;\n          stack = stack.next;\n          if (i < heightMinus1) {\n            yp += width;\n          }\n        }\n        yi = x;\n        stackIn = stackStart;\n        stackOut = stackEnd;\n        for (y = _q = 0; 0 <= height ? _q < height : _q > height; y = 0 <= height ? ++_q : --_q) {\n          p = yi << 2;\n          pixels[p] = (r_sum * mul_sum) >> shg_sum;\n          pixels[p + 1] = (g_sum * mul_sum) >> shg_sum;\n          pixels[p + 2] = (b_sum * mul_sum) >> shg_sum;\n          r_sum -= r_out_sum;\n          g_sum -= g_out_sum;\n          b_sum -= b_out_sum;\n          r_out_sum -= stackIn.r;\n          g_out_sum -= stackIn.g;\n          b_out_sum -= stackIn.b;\n          p = (x + (((p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width)) << 2;\n          r_sum += (r_in_sum += (stackIn.r = pixels[p]));\n          g_sum += (g_in_sum += (stackIn.g = pixels[p + 1]));\n          b_sum += (b_in_sum += (stackIn.b = pixels[p + 2]));\n          stackIn = stackIn.next;\n          r_out_sum += (pr = stackOut.r);\n          g_out_sum += (pg = stackOut.g);\n          b_out_sum += (pb = stackOut.b);\n          r_in_sum -= pr;\n          g_in_sum -= pg;\n          b_in_sum -= pb;\n          stackOut = stackOut.next;\n          yi += width;\n        }\n      }\n      return this;\n    });\n    return Caman.Filter.register(\"stackBlur\", function(radius) {\n      return this.processPlugin(\"stackBlur\", [radius]);\n    });\n  })();\n\n  Caman.Filter.register(\"threshold\", function(adjust) {\n    return this.process(\"threshold\", function(rgba) {\n      var luminance;\n\n      luminance = (0.2126 * rgba.r) + (0.7152 * rgba.g) + (0.0722 * rgba.b);\n      if (luminance < adjust) {\n        rgba.r = 0;\n        rgba.g = 0;\n        rgba.b = 0;\n      } else {\n        rgba.r = 255;\n        rgba.g = 255;\n        rgba.b = 255;\n      }\n      return rgba;\n    });\n  });\n\n}).call(this);\n"]}